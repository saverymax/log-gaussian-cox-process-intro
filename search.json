[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "INLA and Log Gaussian Cox Processes: Theory and Application",
    "section": "",
    "text": "Preface\nThis is the blog post regarding Log-Gaussian Cox Processes.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  Introduction",
    "section": "",
    "text": "This is a blog post about Log-Gaussian Cox Processes (LGCP). It is a follow up to the earlier blog post I made about Poisson Point Process models. In fact, the LGCP is an extension of the Poisson Point Process, in that a latent correlation structure is included in the point process model. Specifically, the LGCP uses a Gaussian Random Field to characterize the intensity of the point process. Doing so allows us to take into account spatial or temporal correlation across our region or period of interest. Statistically, this is quite an advantageous improvement from the Poisson Point Process where spatial correlation could only be accounted for via covariates. However, the inclusion of the random field presents mathematical and computational challenges. We will address these challenges here, making use of the Integrated Nested Laplace Approximation (INLA) approach.\nThe general structure of this post is as follows: I will first introduce the LGCP, but only briefly, as most of the theory is the same for the Poisson Process as the LGCP. Then, I’ll spend some time covering the INLA method and the accompanying R packages, INLA and inlabru. I’ll compare these packages for fitting models of continuous measures and, of course, point processes. At some point I will end the post and continue later with another about fitting multiple likelihood models in inla, such as for the purpose of accounting for preferential sampling.\nThe reason I am writing about this is because having a model that incorporates spatial (or temporal) correlation via the Gaussian field is necessary to properly model both point processes (such as the Presence-only data of the last blog) or continuous measures in spatial-temporal intervals (such as air pollution). Not including correlation via the GF means that you then assume the covariates included in your model are sufficient to account for spatial fluctuations in the measurement. The problem with this is that is there no direct mechanism to relate the behavior of the process at one location to the behavior at another location. The GF does exactly this, taking into account the spatial dependence between measurement locations.\nSo this is a more technical topic. The only thing we want to do is include spatial dependence, but we have to first learn a whole new method of approximation and software framework to be able to do so. However, the advantage is the INLA method/software is sufficiently general so that we can tackle a whole set of spatial-temporal modelling problems using the same approach. In fact, the INLA approach allows us to work with both continuous, discrete, and point-type data, and to combine the likelihoods of different datasets as long as the underlying process shares a set of parameters. That is really useful!",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "theory.html",
    "href": "theory.html",
    "title": "2  LGCP theory",
    "section": "",
    "text": "3 INLA\nA Poisson point process is a stochastic set of random variables in 2D space. The LGCP extends the process by incorporating spatial and potentially temporal correlation into the model. (diggle-2013?) is a good reference for these type of models. I’ll give some details below, and then discuss the INLA approach for actually estimating the model.\nThe Poisson Point Process is characterized by an intensity that can be defined as the expected number of observations per unit area. For a given region \\(A\\), the number of individuals occurring within the region will be Poisson distributed. The mean of the distribution can be defined by the integral of the intensity over the region: \\[\n\\Delta(A) = \\int_A \\lambda(s)ds\n\\] Of course, the intensity is an unobservable and unknown process, and must be modelled as a function of covariates. The intensity takes the general parameterization as \\[\n\\lambda(s) = \\exp[\\alpha + \\beta'x(s)]\n\\] In the previous blog I discussed incorporating sampling bias, but for simplicity I will leave that out now. Some version of this will come back when discussing preferential sampling. Another difference is that in the INLA +SPDE framework, we don’t need to worry about the resolution of our covariates (as much) as we work directly with the location of the points on a triangulated lattice.\nNow, in the log Gaussian Cox Process we incorporate a Gaussian Random Field (also vaguely described as Gaussian spatial field, spatial random effects, or latent spatial field. I’m not sure exactly when the difference in description leads to a distinctly different spatial model) to incorporate spatial correlation in the model of intensity. \\[\n\\lambda(s) = \\exp[\\alpha + \\beta'x(s) + f_s(s)]\n\\] We denote the spatial effect as \\(f_s(s)\\) in order to distinguish from temporal contributions. The Gaussian Random field \\(f(s)\\) can be thought of as a continuous spatial effect that is evaluated at certain locations.\nThat is all I will say about LGCPs. The main thing is that, once we incorporate the latent structure, we are forced to use a covariance structure that grows in size as the area of interest or the number of observations increase in size. Furthermore, we are still stuck with the problem of an intractable integral in the likelihood of the model. Thus, the computational complexity makes this approach prohibitively costly when using MCMC approaches to estimate any slightly non-trivial specifications of this model.\nIntegrated Nested Laplace Approximations have been proposed by (rue-2009?) as a fast way to estimate models with latent Gaussian structure. As it can be seen above, the LGCP is certainly an instance of models of this class. Taking notation directly from the Rue paper, INLA is concerned with models with an additive predictor that have the general form \\[\n\\eta_i = \\alpha + \\sum^{n_f}_{j=1}f^{(j)}(u_{ij}) + \\sum^{n_{\\beta}}_{k=1} \\beta_kz_{ki} + \\epsilon_i\n\\] where \\(\\alpha\\) is an intercept, \\(f\\) are unknown functions of \\(\\mathbf{u}\\), and \\(\\beta\\) are the typical fixed effects effect for covariates \\(\\mathbf{z}\\). Additionally, \\(\\mathbf{x}\\) will refer to the vector of latent Gaussian variables (Gaussian by prior definition), and \\(\\theta\\) the vector of hyperparameters that we usually deal with in a Bayesian model that are not inherently Gaussian. In the book by Blangiardo and Cameletti published in 2015, hyperparameters and latent field are denoted by \\(\\psi\\) and \\(\\theta\\) respectively, which is clearer than using \\(x\\) to describe the latent field, but here I’m sticking to the original notation.\nAgain, still taking from the notation of the Rue paper, the joint posterior is written as \\[\n\\begin{aligned}\n\\pi(x,\\theta|y)\\propto\\pi(\\theta)\\pi(x|\\theta)\\prod_{i\\in I}\\pi(y_i|x_i,\\theta)\\\\\n\\propto\\pi(\\theta)|Q(\\theta)|^{1/2}\\exp\\bigg[-\\frac{1}{2}x^TQ(\\theta)x+\\sum_{i\\in I}\\log\\{\\pi(y_i|x_i,\\theta)\\}\\bigg],\n\\end{aligned}\n\\]\nThe main point of INLA is to make the nested approximations of the posterior marginals of the hyperparameters and (even more importantly) the latent field. The posterior marginal of one component of the hyperparameters is \\[\n\\pi(\\theta_j|y) = \\int \\pi(\\theta|y)d\\theta_{-j}.\n\\] Notice the \\(-j\\) components are integrated out. The posterior marginal of a component of the latent field is \\[\n\\pi(x_i|y) = \\int \\pi(x_i|\\theta,y)\\pi(\\theta|y)d\\theta,\n\\] again, sticking to the \\(\\mathbf{x}\\) notation.\nFollowing the procedure of INLA, first \\(\\pi(\\theta|y)\\) will need to be approximated, and then \\(\\pi(x_i|\\theta,y)\\). The integration to approximate \\(\\pi(x_i|y)\\) will be done numerically. The approximations are done with the Laplace Approximation, or a Gaussian-type approximation. To approximate the first quantity \\(\\pi(\\theta|y)\\), a Laplace approximation is used from Tierney and Kadane, 1986: \\[\n\\tilde{\\pi}(\\theta|y) \\propto \\frac{\\pi(x,\\theta,y)}{\\tilde{\\pi}_G(x|\\theta,y)}\\bigg|_{x=x^*(\\theta)} = \\frac{\\pi(y|x,\\theta)\\pi(x|\\theta)\\pi(\\theta)}{\\tilde{\\pi}_G(x|\\theta,y)}\\bigg|_{x=x^*(\\theta)}.\n\\] Interestingly, this approximation uses a NESTED approximation, \\(\\tilde{\\pi}_G(x|\\theta,y)\\). \\(\\tilde{\\pi}_G\\) is the Gaussian approximation to the latent field, which works because we already know the latent field to be prior-ly distributed as Gaussian.\nThe contribution of this paper is to then approximate \\(\\pi(x_i|, \\theta, y)\\) with a Laplace Approximation (LA), beyond just a simple Gaussian. The paper discusses 3 approximations to \\(\\pi(x_i|\\theta, y)\\): the Gaussian, LA, and a simplified LA.\nThe LA approximation is written as \\[\n\\tilde{\\pi}_{LA}(x_i|\\theta,y) \\propto \\frac{\\pi(x,\\theta,y)}{\\tilde{\\pi}_{GG}(x_{-i}|x_i,\\theta,y)}\\bigg|_{x_{-i}=x^*_{-i}(x_i,\\theta)}.\n\\] This can be computationally intensive since it is necessary to recompute \\(\\tilde{\\pi}_{GG}(x_{-i}|x_i,\\theta,y)\\) for each element of \\(x\\) and \\(\\theta\\). Why?\nOnce the approximations of \\(\\tilde{\\pi}(\\theta|y)\\) of \\(\\tilde{\\pi}(x_i|\\theta,y)\\) are found, the marginals for each element \\(x_i\\) can be approximated:\n\\[\n\\tilde{\\pi}(x_i|y) \\approx\\sum\\tilde{\\pi}(x_i|\\theta^{(i)},y)\\tilde{\\pi}(\\theta^{(j)}|y)\\Delta_j\n\\] for integration points \\(\\theta^{(i)}\\) which are found by the exploration of the posterior for \\(\\theta\\). This is done in a few different ways, for example by creating a standardized \\(Z\\) variable around the mode and inverse hessian of \\(\\log \\tilde\\pi}(\\theta|y)\\). There are quite a few more details to this part that I won’t discuss here, but may come up when up using the INLA software itself (choosing the integration scheme, for instance).",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>LGCP theory</span>"
    ]
  },
  {
    "objectID": "theory.html#spde-connection",
    "href": "theory.html#spde-connection",
    "title": "2  LGCP theory",
    "section": "3.1 SPDE connection",
    "text": "3.1 SPDE connection\nThe Stochastic Partial Differential Equation (SPDE) approach is an innovation from (lindgren-2011?) on the INLA method. The approach allows the representation of a continuous Gaussian Field with a Gaussian Markov Random Field. The connection to the (rue-2009?) paper is that (lindgren-2011?) connected the GRMF models of INLA to specific (continuous) GFs. As spatial statisticians, we care about the continuous case more than approximations in discrete space, and SPDE connected the two.\nTo be slightly more specific, it turns out a GF with Matern covariance is a solution to a specific SPDE. The solution to the SPDE is found via a set of basis functions defined on a triangulation of the spatial region. The resulting GRMF is an approximation to the SPDE. So this approach allows us to approximate the solution of the SPDE with a GRMF that corresponds to a specific GF with matern covariance.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>LGCP theory</span>"
    ]
  },
  {
    "objectID": "theory.html#mesh",
    "href": "theory.html#mesh",
    "title": "2  LGCP theory",
    "section": "3.2 Mesh",
    "text": "3.2 Mesh\nThe mesh is is used to project the discrete GRMF to the continuous GF using some spatial weights defined at the vertices of the mesh (did I say that right?). From the Moraga tutorial above, she says the continuous process is estimated using a weighted average of the process at the vertices of the discrete triangulation mesh.\nThe projection matrix maps the GMRF from the observations to the triangulation nodes. The observation will be the weighted average using the weights and values from the triangulation and projection matrix. \\[\nS(x_i) \\approx \\sum^G_{g=1}A_{ig}S_g\n\\]",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>LGCP theory</span>"
    ]
  },
  {
    "objectID": "theory.html#off-the-grid",
    "href": "theory.html#off-the-grid",
    "title": "2  LGCP theory",
    "section": "3.3 Off the grid",
    "text": "3.3 Off the grid\n(simpson-2016?) developed an approach for approximating the likelihood of the LGCP within the INLA framework, using a random field \\[\nZ(s) = \\sum^n_{i=1}z_i\\phi_i(s)\n\\] TODO: 1-10: Think about what simpson did. ## Concluding the section\nThat was a bit of a longer-than-intended dive into INLA. But INLA is definitely a more mathematically complicated method than other approximations, and I wanted to solidify the details for myself. It’s not always that way, sometimes it’s nice just to jump straight into the application, but with INLA it seemed prudent to pick over the details. Now, onto using the software with some of my own data and use-cases.\nAnyway, having covered, the necessary bits of INLA and LGCPs, I’ll now proceed to discuss the modelling procedure using INLA and inlabru. I’ll compare the software, first for a continuous measurement and then for point data using an LGCP!",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>LGCP theory</span>"
    ]
  },
  {
    "objectID": "inla_inlabru_tutorial_netherlands_data.html",
    "href": "inla_inlabru_tutorial_netherlands_data.html",
    "title": "3  Spatial modelling with INLA and SPDE",
    "section": "",
    "text": "Having covered the need-to-know material for INLA and SPDE, next I’m going to build a spatial model using both INLA and inlabru. Comparing the two packages is useful because, though they can be expected to give the same results in most cases, the implementation is a bit different. Knowing when using the more complicated INLA can be justified is a useful exercise, I think.\nI found https://becarioprecario.bitbucket.io/spde-gitbook/ch-lcox.html and https://becarioprecario.bitbucket.io/inla-gitbook/ch-INLA.html good for details about inla and such specifications. However, this initial tutorial follows that of the book of Paula Moraga https://www.paulamoraga.com/book-spatial/sec-geostatisticaldataSPDE.html, because I found her writing a bit more concise and clear.\nThe model fit here is a simple geostatistical one: \\[\nY_i \\sim N(u_i, \\sigma^2)\\\\\nu_i = \\beta_0\\cdot\\text{temp} + \\beta_1\\cdot\\text{precipitation}_i + S(x_i).\n\\] So it’s a typical Gaussian distributed variable with underlying latent structure. I’m not sure what the most accurate statistical way to say this is; potentially a spatial random effect “modelled as a Gaussian process”. This is what Paula Moraga calls “geostatistical data”, that is, measurements taken at discrete locations but used to describe or estimate a spatially continuous process, such as air pollution. It is very similar to a mixed model with a random effect. In this case the random effect is Gaussian distributed and spatially indexed.\nIt’s a simple model, so let’s get straight to data downloading and processing. I download air pollution data in the Netherlands for the year of 2023 from https://eeadmz1-downloads-webapp.azurewebsites.net/.\n\nlibrary(INLA)\n\nLoading required package: Matrix\n\n\nLoading required package: sp\n\n\nThis is INLA_24.05.01-1 built 2024-05-01 18:49:50 UTC.\n - See www.r-inla.org/contact-us for how to get help.\n - List available models/likelihoods/etc with inla.list.models()\n - Use inla.doc(&lt;NAME&gt;) to access documentation\n\nlibrary(inlabru)\n\nLoading required package: fmesher\n\nlibrary(sf)\n\nLinking to GEOS 3.11.2, GDAL 3.8.2, PROJ 9.3.1; sf_use_s2() is TRUE\n\nlibrary(rnaturalearth)\nlibrary(ggplot2)\nlibrary(viridis)\n\nLoading required package: viridisLite\n\nlibrary(terra)\n\nterra 1.7.78\n\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\n\nThe following object is masked from 'package:terra':\n\n    buffer\n\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:terra':\n\n    intersect, union\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(stringr)\nlibrary(readr)\n#data_path &lt;- file.path(\"D:\", \"data\", \"air_quality_data\", \"belgium_eea\", \"E1a\")\ndata_path &lt;- file.path(\"D:\", \"data\", \"air_quality_data\", \"netherlands_eea\", \"E1a\")\nd &lt;- open_dataset(data_path)\nd\n\nFileSystemDataset with 199 Parquet files\n12 columns\nSamplingpoint: string\nPollutant: int32\nStart: timestamp[ns] not null\nEnd: timestamp[ns] not null\nValue: decimal128(38, 18)\nUnit: string\nAggType: string\nValidity: int32 not null\nVerification: int32 not null\nResultTime: timestamp[ns] not null\nDataCapture: decimal128(38, 18)\nFkObservationLog: string\n\n# 8 Nitrogen dioxide\n# 5 Particulate matter &lt; 10 µm\n# 6001  Particulate matter &lt; 2.5 µm\nd %&gt;% group_by(Samplingpoint) |&gt; filter(Pollutant==6001, Value&gt;-1) |&gt; collect() -&gt; df\ndf\n\n# A tibble: 442,873 × 12\n# Groups:   Samplingpoint [53]\n   Samplingpoint   Pollutant Start               End                 Value Unit \n   &lt;chr&gt;               &lt;int&gt; &lt;dttm&gt;              &lt;dttm&gt;              &lt;dbl&gt; &lt;chr&gt;\n 1 NL/SPO-NL00007…      6001 2023-01-01 01:00:00 2023-01-01 02:00:00 131.  ug.m…\n 2 NL/SPO-NL00007…      6001 2023-01-01 02:00:00 2023-01-01 03:00:00  86.2 ug.m…\n 3 NL/SPO-NL00007…      6001 2023-01-01 03:00:00 2023-01-01 04:00:00  30.7 ug.m…\n 4 NL/SPO-NL00007…      6001 2023-01-01 04:00:00 2023-01-01 05:00:00  11   ug.m…\n 5 NL/SPO-NL00007…      6001 2023-01-01 05:00:00 2023-01-01 06:00:00   9.1 ug.m…\n 6 NL/SPO-NL00007…      6001 2023-01-01 06:00:00 2023-01-01 07:00:00   5.3 ug.m…\n 7 NL/SPO-NL00007…      6001 2023-01-01 07:00:00 2023-01-01 08:00:00   2.8 ug.m…\n 8 NL/SPO-NL00007…      6001 2023-01-01 08:00:00 2023-01-01 09:00:00   2.3 ug.m…\n 9 NL/SPO-NL00007…      6001 2023-01-01 10:00:00 2023-01-01 11:00:00  -0.6 ug.m…\n10 NL/SPO-NL00007…      6001 2023-01-01 11:00:00 2023-01-01 12:00:00   1.4 ug.m…\n# ℹ 442,863 more rows\n# ℹ 6 more variables: AggType &lt;chr&gt;, Validity &lt;int&gt;, Verification &lt;int&gt;,\n#   ResultTime &lt;dttm&gt;, DataCapture &lt;dbl&gt;, FkObservationLog &lt;chr&gt;\n\n\nAdd locations to the sampling stations.\n\ndf\n\n# A tibble: 442,873 × 12\n# Groups:   Samplingpoint [53]\n   Samplingpoint   Pollutant Start               End                 Value Unit \n   &lt;chr&gt;               &lt;int&gt; &lt;dttm&gt;              &lt;dttm&gt;              &lt;dbl&gt; &lt;chr&gt;\n 1 NL/SPO-NL00007…      6001 2023-01-01 01:00:00 2023-01-01 02:00:00 131.  ug.m…\n 2 NL/SPO-NL00007…      6001 2023-01-01 02:00:00 2023-01-01 03:00:00  86.2 ug.m…\n 3 NL/SPO-NL00007…      6001 2023-01-01 03:00:00 2023-01-01 04:00:00  30.7 ug.m…\n 4 NL/SPO-NL00007…      6001 2023-01-01 04:00:00 2023-01-01 05:00:00  11   ug.m…\n 5 NL/SPO-NL00007…      6001 2023-01-01 05:00:00 2023-01-01 06:00:00   9.1 ug.m…\n 6 NL/SPO-NL00007…      6001 2023-01-01 06:00:00 2023-01-01 07:00:00   5.3 ug.m…\n 7 NL/SPO-NL00007…      6001 2023-01-01 07:00:00 2023-01-01 08:00:00   2.8 ug.m…\n 8 NL/SPO-NL00007…      6001 2023-01-01 08:00:00 2023-01-01 09:00:00   2.3 ug.m…\n 9 NL/SPO-NL00007…      6001 2023-01-01 10:00:00 2023-01-01 11:00:00  -0.6 ug.m…\n10 NL/SPO-NL00007…      6001 2023-01-01 11:00:00 2023-01-01 12:00:00   1.4 ug.m…\n# ℹ 442,863 more rows\n# ℹ 6 more variables: AggType &lt;chr&gt;, Validity &lt;int&gt;, Verification &lt;int&gt;,\n#   ResultTime &lt;dttm&gt;, DataCapture &lt;dbl&gt;, FkObservationLog &lt;chr&gt;\n\ndf &lt;- df %&gt;%\n   #mutate(Samplingpoint = str_remove(Samplingpoint, \"BE/\"))\n   mutate(Samplingpoint = str_remove(Samplingpoint, \"NL/\"))\n#station_location_path &lt;- file.path(\"D:\", \"data\", \"air_quality_data\", \"eea_stations_2023\", \"belgium_stations_2023.csv\")\nstation_location_path &lt;- file.path(\"D:\", \"data\", \"air_quality_data\", \"eea_stations_2023\", \"nl_stations_2023.csv\")\nstation_locations &lt;- read_csv(station_location_path)\n\nRows: 4685 Columns: 27\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (19): Country, Air Quality Network, Air Quality Network Name, Air Qualit...\ndbl  (8): Year, Air Pollution Level, Data Coverage, Verification, Longitude,...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nstation_locations &lt;- rename(station_locations, Samplingpoint = 'Sampling Point Id')\nstation_locations %&gt;% \n  distinct(Samplingpoint, Longitude, Latitude) -&gt; unique_locations\nmerged_df &lt;- df %&gt;% \n  left_join(unique_locations %&gt;% select(Samplingpoint, Longitude, Latitude), by = \"Samplingpoint\")\nmerged_df\n\n# A tibble: 442,873 × 14\n# Groups:   Samplingpoint [53]\n   Samplingpoint   Pollutant Start               End                 Value Unit \n   &lt;chr&gt;               &lt;int&gt; &lt;dttm&gt;              &lt;dttm&gt;              &lt;dbl&gt; &lt;chr&gt;\n 1 SPO-NL00007_06…      6001 2023-01-01 01:00:00 2023-01-01 02:00:00 131.  ug.m…\n 2 SPO-NL00007_06…      6001 2023-01-01 02:00:00 2023-01-01 03:00:00  86.2 ug.m…\n 3 SPO-NL00007_06…      6001 2023-01-01 03:00:00 2023-01-01 04:00:00  30.7 ug.m…\n 4 SPO-NL00007_06…      6001 2023-01-01 04:00:00 2023-01-01 05:00:00  11   ug.m…\n 5 SPO-NL00007_06…      6001 2023-01-01 05:00:00 2023-01-01 06:00:00   9.1 ug.m…\n 6 SPO-NL00007_06…      6001 2023-01-01 06:00:00 2023-01-01 07:00:00   5.3 ug.m…\n 7 SPO-NL00007_06…      6001 2023-01-01 07:00:00 2023-01-01 08:00:00   2.8 ug.m…\n 8 SPO-NL00007_06…      6001 2023-01-01 08:00:00 2023-01-01 09:00:00   2.3 ug.m…\n 9 SPO-NL00007_06…      6001 2023-01-01 10:00:00 2023-01-01 11:00:00  -0.6 ug.m…\n10 SPO-NL00007_06…      6001 2023-01-01 11:00:00 2023-01-01 12:00:00   1.4 ug.m…\n# ℹ 442,863 more rows\n# ℹ 8 more variables: AggType &lt;chr&gt;, Validity &lt;int&gt;, Verification &lt;int&gt;,\n#   ResultTime &lt;dttm&gt;, DataCapture &lt;dbl&gt;, FkObservationLog &lt;chr&gt;,\n#   Longitude &lt;dbl&gt;, Latitude &lt;dbl&gt;\n\nstation_locations_sf &lt;- st_as_sf(station_locations, coords = c(\"Longitude\", \"Latitude\"))\nair_sf &lt;- st_as_sf(merged_df, coords = c(\"Longitude\", \"Latitude\"))\nst_crs(air_sf) &lt;- \"EPSG:4326\"\nair_sf\n\nSimple feature collection with 442873 features and 12 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 3.8386 ymin: 50.888 xmax: 6.9195 ymax: 53.3304\nGeodetic CRS:  WGS 84\n# A tibble: 442,873 × 13\n# Groups:   Samplingpoint [53]\n   Samplingpoint   Pollutant Start               End                 Value Unit \n * &lt;chr&gt;               &lt;int&gt; &lt;dttm&gt;              &lt;dttm&gt;              &lt;dbl&gt; &lt;chr&gt;\n 1 SPO-NL00007_06…      6001 2023-01-01 01:00:00 2023-01-01 02:00:00 131.  ug.m…\n 2 SPO-NL00007_06…      6001 2023-01-01 02:00:00 2023-01-01 03:00:00  86.2 ug.m…\n 3 SPO-NL00007_06…      6001 2023-01-01 03:00:00 2023-01-01 04:00:00  30.7 ug.m…\n 4 SPO-NL00007_06…      6001 2023-01-01 04:00:00 2023-01-01 05:00:00  11   ug.m…\n 5 SPO-NL00007_06…      6001 2023-01-01 05:00:00 2023-01-01 06:00:00   9.1 ug.m…\n 6 SPO-NL00007_06…      6001 2023-01-01 06:00:00 2023-01-01 07:00:00   5.3 ug.m…\n 7 SPO-NL00007_06…      6001 2023-01-01 07:00:00 2023-01-01 08:00:00   2.8 ug.m…\n 8 SPO-NL00007_06…      6001 2023-01-01 08:00:00 2023-01-01 09:00:00   2.3 ug.m…\n 9 SPO-NL00007_06…      6001 2023-01-01 10:00:00 2023-01-01 11:00:00  -0.6 ug.m…\n10 SPO-NL00007_06…      6001 2023-01-01 11:00:00 2023-01-01 12:00:00   1.4 ug.m…\n# ℹ 442,863 more rows\n# ℹ 7 more variables: AggType &lt;chr&gt;, Validity &lt;int&gt;, Verification &lt;int&gt;,\n#   ResultTime &lt;dttm&gt;, DataCapture &lt;dbl&gt;, FkObservationLog &lt;chr&gt;,\n#   geometry &lt;POINT [°]&gt;\n\n\nThen examine the time series\n\ndistinct_stations &lt;- unique(air_sf$Samplingpoint)[1:12]\nplotting_stations &lt;- air_sf[air_sf$Samplingpoint%in%distinct_stations,]\nplotting_stations\n\nSimple feature collection with 98311 features and 12 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 4.781 ymin: 50.888 xmax: 5.9869 ymax: 52.394\nGeodetic CRS:  WGS 84\n# A tibble: 98,311 × 13\n# Groups:   Samplingpoint [12]\n   Samplingpoint   Pollutant Start               End                 Value Unit \n   &lt;chr&gt;               &lt;int&gt; &lt;dttm&gt;              &lt;dttm&gt;              &lt;dbl&gt; &lt;chr&gt;\n 1 SPO-NL00007_06…      6001 2023-01-01 01:00:00 2023-01-01 02:00:00 131.  ug.m…\n 2 SPO-NL00007_06…      6001 2023-01-01 02:00:00 2023-01-01 03:00:00  86.2 ug.m…\n 3 SPO-NL00007_06…      6001 2023-01-01 03:00:00 2023-01-01 04:00:00  30.7 ug.m…\n 4 SPO-NL00007_06…      6001 2023-01-01 04:00:00 2023-01-01 05:00:00  11   ug.m…\n 5 SPO-NL00007_06…      6001 2023-01-01 05:00:00 2023-01-01 06:00:00   9.1 ug.m…\n 6 SPO-NL00007_06…      6001 2023-01-01 06:00:00 2023-01-01 07:00:00   5.3 ug.m…\n 7 SPO-NL00007_06…      6001 2023-01-01 07:00:00 2023-01-01 08:00:00   2.8 ug.m…\n 8 SPO-NL00007_06…      6001 2023-01-01 08:00:00 2023-01-01 09:00:00   2.3 ug.m…\n 9 SPO-NL00007_06…      6001 2023-01-01 10:00:00 2023-01-01 11:00:00  -0.6 ug.m…\n10 SPO-NL00007_06…      6001 2023-01-01 11:00:00 2023-01-01 12:00:00   1.4 ug.m…\n# ℹ 98,301 more rows\n# ℹ 7 more variables: AggType &lt;chr&gt;, Validity &lt;int&gt;, Verification &lt;int&gt;,\n#   ResultTime &lt;dttm&gt;, DataCapture &lt;dbl&gt;, FkObservationLog &lt;chr&gt;,\n#   geometry &lt;POINT [°]&gt;\n\nplotting_stations %&gt;% \n  ggplot(aes(x=Start, y=Value)) + \n    geom_line() + \n    facet_wrap(~ Samplingpoint) +\n    theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n    labs(title = \"Time series of monitoring stations\", x = \"Time, hourly\", y = \"Conc (μg/m³)\")\n\n\n\n\n\n\n\n\n\nair_sf &lt;- air_sf %&gt;% filter(Start==as.POSIXct(\"2023-01-01 16:00:00  \"))\ndim(air_sf)\n\n[1] 52 13\n\nair_sf\n\nSimple feature collection with 52 features and 12 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 3.8386 ymin: 50.888 xmax: 6.9195 ymax: 53.3304\nGeodetic CRS:  WGS 84\n# A tibble: 52 × 13\n# Groups:   Samplingpoint [52]\n   Samplingpoint   Pollutant Start               End                 Value Unit \n * &lt;chr&gt;               &lt;int&gt; &lt;dttm&gt;              &lt;dttm&gt;              &lt;dbl&gt; &lt;chr&gt;\n 1 SPO-NL00007_06…      6001 2023-01-01 16:00:00 2023-01-01 17:00:00  4.4  ug.m…\n 2 SPO-NL00012_06…      6001 2023-01-01 16:00:00 2023-01-01 17:00:00  2.9  ug.m…\n 3 SPO-NL00014_06…      6001 2023-01-01 16:00:00 2023-01-01 17:00:00  3.8  ug.m…\n 4 SPO-NL00016_06…      6001 2023-01-01 16:00:00 2023-01-01 17:00:00  8    ug.m…\n 5 SPO-NL00017_06…      6001 2023-01-01 16:00:00 2023-01-01 17:00:00  3.5  ug.m…\n 6 SPO-NL00131_06…      6001 2023-01-01 16:00:00 2023-01-01 17:00:00  8.21 ug.m…\n 7 SPO-NL00136_06…      6001 2023-01-01 16:00:00 2023-01-01 17:00:00  1.16 ug.m…\n 8 SPO-NL00230_06…      6001 2023-01-01 16:00:00 2023-01-01 17:00:00  2.98 ug.m…\n 9 SPO-NL00240_06…      6001 2023-01-01 16:00:00 2023-01-01 17:00:00  2.17 ug.m…\n10 SPO-NL00241_06…      6001 2023-01-01 16:00:00 2023-01-01 17:00:00  6.33 ug.m…\n# ℹ 42 more rows\n# ℹ 7 more variables: AggType &lt;chr&gt;, Validity &lt;int&gt;, Verification &lt;int&gt;,\n#   ResultTime &lt;dttm&gt;, DataCapture &lt;dbl&gt;, FkObservationLog &lt;chr&gt;,\n#   geometry &lt;POINT [°]&gt;\n\n\nThen let’s load a map of the Netherlands. The border is from https://service.pdok.nl/kadaster/bestuurlijkegrenzen/atom/bestuurlijke_grenzen.xml.\n\nmap &lt;- st_read(file.path(\"D:\", \"data\", \"maps\", \"netherlands_bestuurlijkegrenzen_2021\", \"bestuurlijkegrenzen.gpkg\"))\n\nMultiple layers are present in data source D:\\data\\maps\\netherlands_bestuurlijkegrenzen_2021\\bestuurlijkegrenzen.gpkg, reading layer `gemeenten'.\nUse `st_layers' to list all layer names and their type in a data source.\nSet the `layer' argument in `st_read' to read a particular layer.\n\n\nWarning in CPL_read_ogr(dsn, layer, query, as.character(options), quiet, :\nautomatically selected the first layer in a data source containing more than\none.\n\n\nReading layer `gemeenten' from data source \n  `D:\\data\\maps\\netherlands_bestuurlijkegrenzen_2021\\bestuurlijkegrenzen.gpkg' \n  using driver `GPKG'\nSimple feature collection with 352 features and 2 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 10425.16 ymin: 306846.2 xmax: 278026.1 ymax: 621876.3\nProjected CRS: Amersfoort / RD New\n\nmap &lt;- st_union(map)\nmap &lt;- st_as_sf(map)\nmap &lt;- st_transform(map, crs = st_crs(air_sf))\n# raster grid covering map\ngrid &lt;- terra::rast(map, nrows = 100, ncols = 100)\ngrid\n\nclass       : SpatRaster \ndimensions  : 100, 100, 1  (nrow, ncol, nlyr)\nresolution  : 0.03919561, 0.02826056  (x, y)\nextent      : 3.307938, 7.227498, 50.75037, 53.57642  (xmin, xmax, ymin, ymax)\ncoord. ref. : lon/lat WGS 84 (EPSG:4326) \n\n# coordinates of all cells\nxy &lt;- terra::xyFromCell(grid, 1:ncell(grid))\n# transform points to a sf object\ndp &lt;- st_as_sf(as.data.frame(xy), coords = c(\"x\", \"y\"),\n                 crs = st_crs(map))\n\n# indices points within the map\nindicespointswithin &lt;- which(st_intersects(dp, map,\n                                           sparse = FALSE))\nlength(indicespointswithin)\n\n[1] 4944\n\n# points within the map\ndp &lt;- st_filter(dp, map)\n\n# plot\nggplot() + geom_sf(data = map) +\n  geom_sf(data = dp)\n\n\n\n\n\n\n\n\nMore data process\n\nlibrary(geodata)\n# With geodata library\nsave_path &lt;- file.path(\"D:\", \"data\", \"air_quality_data\", \"aux_variables\")\ncovtemp &lt;- worldclim_global(var = \"tavg\", res = 10,\n                            path = save_path)\ncovprec &lt;- worldclim_global(var = \"prec\", res = 10,\n                            path = save_path)\n# Extract at observed locations\nair_sf$covtemp &lt;- extract(mean(covtemp), st_coordinates(air_sf))[, 1]\nair_sf$covprec &lt;- extract(mean(covprec), st_coordinates(air_sf))[, 1]\n# Extract at prediction locations\ndp$covtemp &lt;- extract(mean(covtemp), st_coordinates(dp))[, 1]\ndp$covprec &lt;- extract(mean(covprec), st_coordinates(dp))[, 1]\ndp$covprec\n\n   [1] 67.08333 67.08333 67.58333 67.58333 67.58333 67.58333 67.58333 67.08333\n   [9] 67.08333 67.08333 67.08333 67.58333 67.58333 67.58333 67.58333 67.58333\n  [17] 65.25000       NA 66.08333 66.08333 66.08333 66.08333 67.08333 67.08333\n  [25] 67.08333 67.08333 67.58333 67.58333 67.58333 67.58333 67.58333 65.25000\n  [33] 65.25000 65.25000 66.08333 66.08333 68.16667 68.16667 68.16667 68.16667\n  [41] 68.16667 68.16667 68.16667 68.16667 66.83333 66.83333 66.83333 66.83333\n  [49] 67.41667 67.41667 67.41667 67.41667 69.08333 69.08333 69.08333 69.08333\n  [57] 69.08333 67.91667 67.91667 67.91667 67.91667 66.33333 66.08333 66.08333\n  [65] 66.08333 66.08333 68.08333 68.08333 68.08333 68.08333 68.16667 68.16667\n  [73] 68.16667 68.16667 68.16667 68.16667 68.16667 68.16667 68.16667 66.83333\n  [81] 66.83333 66.83333 66.83333 67.41667 67.41667 67.41667 67.41667 69.08333\n  [89] 69.08333 69.08333 69.08333 69.08333 67.91667 67.91667 67.91667 67.91667\n  [97] 65.00000 65.00000 66.25000 66.25000 66.33333 66.33333 66.33333 66.33333\n [105] 66.08333 66.08333 66.08333 66.08333 68.08333 68.08333 68.08333 68.08333\n [113] 68.16667 68.16667 68.16667 68.16667 68.16667 68.16667 68.16667 68.16667\n [121] 68.16667 66.83333 66.83333 66.83333 66.83333 67.41667 67.41667 67.41667\n [129] 67.41667 69.08333 69.08333 69.08333 69.08333 69.08333 67.91667 67.91667\n [137] 67.91667 67.91667 65.00000 65.00000 65.00000 66.25000 66.25000 66.25000\n [145] 66.25000 66.25000 66.33333 66.33333 66.33333 66.33333 66.08333 66.08333\n [153] 66.08333 66.08333 68.08333 68.08333 68.08333 68.08333 68.16667 68.16667\n [161] 68.16667 68.16667 68.16667 68.16667 68.16667 68.16667 68.16667 66.83333\n [169] 66.83333 66.83333 66.83333 67.41667 67.41667 67.41667 67.41667 69.08333\n [177] 69.08333 69.08333 69.08333 69.08333 67.91667 67.91667 67.91667 67.91667\n [185] 65.00000 65.00000 65.00000 66.33333 66.25000 66.25000 66.25000 66.25000\n [193] 66.25000 66.33333 66.33333 66.33333 66.33333 66.08333 66.08333 66.08333\n [201] 66.08333 68.08333 68.08333 68.08333 68.08333 68.16667 68.16667 68.16667\n [209] 68.16667 68.16667 68.16667 68.16667 68.16667 68.16667 66.83333 66.83333\n [217] 66.83333 66.83333 67.41667 67.41667 67.41667 67.41667 69.08333 69.08333\n [225] 69.08333 69.08333 69.08333 67.91667 67.91667 67.91667 67.91667 65.00000\n [233] 65.00000 65.00000 65.00000 66.33333 66.25000 66.25000 66.25000 66.25000\n [241] 66.25000 66.33333 66.33333 66.33333 66.33333 66.08333 66.08333 66.08333\n [249] 66.08333 68.08333 68.08333 68.08333 68.08333 68.16667 68.16667 68.16667\n [257] 68.16667 68.16667 68.16667 68.16667 68.16667 68.16667 66.83333 66.83333\n [265] 66.83333 66.83333 67.41667 67.41667 67.41667 67.41667 69.08333 69.08333\n [273] 69.08333 69.08333 69.08333 67.91667 67.91667 67.91667 67.91667 65.00000\n [281] 65.00000 65.00000 65.00000 65.83333 65.83333 65.83333 65.33333 65.33333\n [289] 65.33333 65.33333 65.33333 65.25000 65.25000 65.25000 65.25000 66.75000\n [297] 66.75000 66.75000 66.75000 67.58333 67.58333 67.58333 67.58333 67.83333\n [305] 67.83333 67.83333 67.83333 67.83333 69.00000 69.00000 69.00000 69.00000\n [313] 68.91667 68.91667 68.91667 68.91667 67.41667 67.41667 67.41667 67.41667\n [321] 67.00000 67.00000 67.00000 67.00000 67.00000 66.75000 66.75000 66.75000\n [329] 66.75000 64.83333 64.83333 64.83333 64.83333 64.08333 64.08333 64.08333\n [337] 64.08333 63.41667 67.50000 65.83333 65.83333 65.83333 65.83333 65.33333\n [345] 65.33333 65.33333 65.33333 65.33333 65.25000 65.25000 65.25000 65.25000\n [353] 66.75000 66.75000 66.75000 66.75000 67.58333 67.58333 67.58333 67.58333\n [361] 67.83333 67.83333 67.83333 67.83333 67.83333 69.00000 69.00000 69.00000\n [369] 69.00000 68.91667 68.91667 68.91667 68.91667 67.41667 67.41667 67.41667\n [377] 67.41667 67.00000 67.00000 67.00000 67.00000 67.00000 66.75000 66.75000\n [385] 66.75000 66.75000 64.83333 64.83333 64.83333 64.83333 64.08333 64.08333\n [393] 64.08333 64.08333 63.41667 67.50000 67.50000 67.50000 65.83333 65.83333\n [401] 65.83333 65.83333 65.33333 65.33333 65.33333 65.33333 65.33333 65.25000\n [409] 65.25000 65.25000 65.25000 66.75000 66.75000 66.75000 66.75000 67.58333\n [417] 67.58333 67.58333 67.58333 67.83333 67.83333 67.83333 67.83333 67.83333\n [425] 69.00000 69.00000 69.00000 69.00000 68.91667 68.91667 68.91667 68.91667\n [433] 67.41667 67.41667 67.41667 67.41667 67.00000 67.00000 67.00000 67.00000\n [441] 67.00000 66.75000 66.75000 66.75000 66.75000 64.83333 64.83333 64.83333\n [449] 64.83333 64.08333 64.08333 64.08333 64.08333 63.41667 67.50000 67.50000\n [457] 67.50000 67.50000 65.83333 65.83333 65.83333 65.83333 65.33333 65.33333\n [465] 65.33333 65.33333 65.33333 65.25000 65.25000 65.25000 65.25000 66.75000\n [473] 66.75000 66.75000 66.75000 67.58333 67.58333 67.58333 67.58333 67.83333\n [481] 67.83333 67.83333 67.83333 67.83333 69.00000 69.00000 69.00000 69.00000\n [489] 68.91667 68.91667 68.91667 68.91667 67.41667 67.41667 67.41667 67.41667\n [497] 67.00000 67.00000 67.00000 67.00000 67.00000 66.75000 66.75000 66.75000\n [505] 66.75000 64.83333 64.83333 64.83333 64.83333 64.08333 64.08333 64.08333\n [513] 64.08333 63.41667 63.41667 67.50000 67.50000 67.50000 67.50000 65.83333\n [521] 65.83333 65.83333 65.83333 65.33333 65.33333 65.33333 65.33333 65.33333\n [529] 65.25000 65.25000 65.25000 65.25000 66.75000 66.75000 66.75000 66.75000\n [537] 67.58333 67.58333 67.58333 67.58333 67.83333 67.83333 67.83333 67.83333\n [545] 67.83333 69.00000 69.00000 69.00000 69.00000 68.91667 68.91667 68.91667\n [553] 68.91667 67.41667 67.41667 67.41667 67.41667 67.00000 67.00000 67.00000\n [561] 67.00000 67.00000 66.75000 66.75000 66.75000 66.75000 64.83333 64.83333\n [569] 64.83333 64.83333 64.08333 64.08333 64.08333 64.08333 63.41667 63.41667\n [577] 65.75000 66.41667 66.41667 66.41667 66.41667       NA       NA       NA\n [585]       NA 64.08333 64.08333 64.08333 64.08333 64.08333 62.75000 62.75000\n [593] 62.75000 62.75000 65.33333 65.33333 65.33333 65.33333 65.91667 65.91667\n [601] 65.91667 65.91667 66.00000 66.00000 66.00000 66.00000 66.00000 69.08333\n [609] 69.08333 69.08333 69.08333 71.16667 71.16667 71.16667 71.16667 69.58333\n [617] 69.58333 69.58333 69.58333 67.16667 67.16667 67.16667 67.16667 67.16667\n [625] 66.41667 66.41667 66.41667 66.41667 65.08333 65.08333 65.08333 65.08333\n [633] 63.58333 63.58333 63.58333 63.58333 63.50000 65.75000 65.75000 66.41667\n [641] 66.41667 66.41667 66.41667       NA       NA       NA       NA 64.08333\n [649] 64.08333 64.08333 64.08333 64.08333 62.75000 62.75000 62.75000 62.75000\n [657] 65.33333 65.33333 65.33333 65.33333 65.91667 65.91667 65.91667 65.91667\n [665] 66.00000 66.00000 66.00000 66.00000 66.00000 69.08333 69.08333 69.08333\n [673] 69.08333 71.16667 71.16667 71.16667 71.16667 69.58333 69.58333 69.58333\n [681] 69.58333 67.16667 67.16667 67.16667 67.16667 67.16667 66.41667 66.41667\n [689] 66.41667 66.41667 65.08333 65.08333 65.08333 65.08333 63.58333 63.58333\n [697] 63.58333 63.58333 63.50000 65.75000 65.75000 66.41667 66.41667 66.41667\n [705] 66.41667       NA       NA       NA       NA 64.08333 64.08333 64.08333\n [713] 64.08333 64.08333 62.75000 62.75000 62.75000 62.75000 65.33333 65.33333\n [721] 65.33333 65.33333 65.91667 65.91667 65.91667 65.91667 66.00000 66.00000\n [729] 66.00000 66.00000 66.00000 69.08333 69.08333 69.08333 69.08333 71.16667\n [737] 71.16667 71.16667 71.16667 69.58333 69.58333 69.58333 69.58333 67.16667\n [745] 67.16667 67.16667 67.16667 67.16667 66.41667 66.41667 66.41667 66.41667\n [753] 65.08333 65.08333 65.08333 65.08333 63.58333 63.58333 63.58333 63.58333\n [761] 63.50000 65.75000 65.75000 65.75000 66.41667 66.41667 66.41667 66.41667\n [769]       NA       NA       NA       NA 64.08333 64.08333 64.08333 64.08333\n [777] 64.08333 62.75000 62.75000 62.75000 62.75000 65.33333 65.33333 65.33333\n [785] 65.33333 65.91667 65.91667 65.91667 65.91667 66.00000 66.00000 66.00000\n [793] 66.00000 66.00000 69.08333 69.08333 69.08333 69.08333 71.16667 71.16667\n [801] 71.16667 71.16667 69.58333 69.58333 69.58333 69.58333 67.16667 67.16667\n [809] 67.16667 67.16667 67.16667 66.41667 66.41667 66.41667 66.41667 65.08333\n [817] 65.08333 65.08333 65.08333 63.58333 63.58333 63.58333 63.58333 63.50000\n [825] 65.75000 65.75000 65.75000 65.75000 66.41667 66.41667 66.41667 66.41667\n [833]       NA       NA       NA       NA 64.08333 64.08333 64.08333 64.08333\n [841] 64.08333 62.75000 62.75000 62.75000 62.75000 65.33333 65.33333 65.33333\n [849] 65.33333 65.91667 65.91667 65.91667 65.91667 66.00000 66.00000 66.00000\n [857] 66.00000 66.00000 69.08333 69.08333 69.08333 69.08333 71.16667 71.16667\n [865] 71.16667 71.16667 69.58333 69.58333 69.58333 69.58333 67.16667 67.16667\n [873] 67.16667 67.16667 67.16667 66.41667 66.41667 66.41667 66.41667 65.08333\n [881] 65.08333 65.08333 65.08333 63.58333 63.58333 63.58333 63.58333 63.50000\n [889] 65.75000 65.75000 65.75000 65.75000 66.41667 66.41667 66.41667 66.41667\n [897]       NA       NA       NA       NA 64.08333 64.08333 64.08333 64.08333\n [905] 64.08333 62.75000 62.75000 62.75000 62.75000 65.33333 65.33333 65.33333\n [913] 65.33333 65.91667 65.91667 65.91667 65.91667 66.00000 66.00000 66.00000\n [921] 66.00000 66.00000 69.08333 69.08333 69.08333 69.08333 71.16667 71.16667\n [929] 71.16667 71.16667 69.58333 69.58333 69.58333 69.58333 67.16667 67.16667\n [937] 67.16667 67.16667 67.16667 66.41667 66.41667 66.41667 66.41667 65.08333\n [945] 65.08333 65.08333 65.08333 63.58333 63.58333 63.58333 63.58333 63.50000\n [953] 63.50000 65.00000 65.00000 65.00000 65.00000 66.16667 66.16667 66.16667\n [961] 66.16667 64.25000 64.25000 64.25000 64.25000 65.08333 65.08333 65.08333\n [969] 65.08333 65.08333 63.66667 63.66667 63.66667 63.66667 66.00000 66.00000\n [977] 66.00000 66.00000 67.08333 67.08333 67.08333 67.08333 68.25000 68.25000\n [985] 68.25000 68.25000 68.25000 69.66667 69.66667 69.66667 69.66667 70.66667\n [993] 70.66667 70.66667 70.66667 71.25000 71.25000 71.25000 71.25000 69.08333\n[1001] 69.08333 69.08333 69.08333 69.08333 67.83333 67.83333 67.83333 67.83333\n[1009] 65.08333 65.08333 65.08333 65.08333 62.66667 62.66667 62.66667 62.66667\n[1017] 64.00000 64.00000 67.75000 67.75000 65.00000 65.00000 65.00000 65.00000\n[1025] 66.16667 66.16667 66.16667 66.16667 64.25000 64.25000 64.25000 64.25000\n[1033] 65.08333 65.08333 65.08333 65.08333 65.08333 63.66667 63.66667 63.66667\n[1041] 63.66667 66.00000 66.00000 66.00000 66.00000 67.08333 67.08333 67.08333\n[1049] 67.08333 68.25000 68.25000 68.25000 68.25000 68.25000 69.66667 69.66667\n[1057] 69.66667 69.66667 70.66667 70.66667 70.66667 70.66667 71.25000 71.25000\n[1065] 71.25000 71.25000 69.08333 69.08333 69.08333 69.08333 69.08333 67.83333\n[1073] 67.83333 67.83333 67.83333 65.08333 65.08333 65.08333 65.08333 62.66667\n[1081] 62.66667 62.66667 62.66667 64.00000 67.75000 65.00000 65.00000 65.00000\n[1089] 65.00000 66.16667 66.16667 66.16667 66.16667 64.25000 64.25000 64.25000\n[1097] 64.25000 65.08333 65.08333 65.08333 65.08333 65.08333 63.66667 63.66667\n[1105] 63.66667 63.66667 66.00000 66.00000 66.00000 66.00000 67.08333 67.08333\n[1113] 67.08333 67.08333 68.25000 68.25000 68.25000 68.25000 68.25000 69.66667\n[1121] 69.66667 69.66667 69.66667 70.66667 70.66667 70.66667 70.66667 71.25000\n[1129] 71.25000 71.25000 71.25000 69.08333 69.08333 69.08333 69.08333 69.08333\n[1137] 67.83333 67.83333 67.83333 67.83333 65.08333 65.08333 65.08333 65.08333\n[1145] 62.66667 62.66667 62.66667 62.66667 64.00000 67.75000 65.00000 65.00000\n[1153] 65.00000 65.00000 66.16667 66.16667 66.16667 66.16667 64.25000 64.25000\n[1161] 64.25000 64.25000 65.08333 65.08333 65.08333 65.08333 65.08333 63.66667\n[1169] 63.66667 63.66667 63.66667 66.00000 66.00000 66.00000 66.00000 67.08333\n[1177] 67.08333 67.08333 67.08333 68.25000 68.25000 68.25000 68.25000 68.25000\n[1185] 69.66667 69.66667 69.66667 69.66667 70.66667 70.66667 70.66667 70.66667\n[1193] 71.25000 71.25000 71.25000 71.25000 69.08333 69.08333 69.08333 69.08333\n[1201] 69.08333 67.83333 67.83333 67.83333 67.83333 65.08333 65.08333 65.08333\n[1209] 65.08333 62.66667 62.66667 62.66667 62.66667 65.00000 65.00000 65.00000\n[1217] 65.00000 66.16667 66.16667 66.16667 66.16667 64.25000 64.25000 64.25000\n[1225] 64.25000 65.08333 65.08333 65.08333 65.08333 65.08333 63.66667 63.66667\n[1233] 63.66667 63.66667 66.00000 66.00000 66.00000 66.00000 67.08333 67.08333\n[1241] 67.08333 67.08333 68.25000 68.25000 68.25000 68.25000 68.25000 69.66667\n[1249] 69.66667 69.66667 69.66667 70.66667 70.66667 70.66667 70.66667 71.25000\n[1257] 71.25000 71.25000 71.25000 69.08333 69.08333 69.08333 69.08333 69.08333\n[1265] 67.83333 67.83333 67.83333 67.83333 65.08333 65.08333 65.08333 65.08333\n[1273] 62.66667 62.66667 62.66667 65.00000 65.00000 65.00000 65.00000 66.16667\n[1281] 66.16667 66.16667 66.16667 64.25000 64.25000 64.25000 64.25000 65.08333\n[1289] 65.08333 65.08333 65.08333 65.08333 63.66667 63.66667 63.66667 63.66667\n[1297] 66.00000 66.00000 66.00000 66.00000 67.08333 67.08333 67.08333 67.08333\n[1305] 68.25000 68.25000 68.25000 68.25000 68.25000 69.66667 69.66667 69.66667\n[1313] 69.66667 70.66667 70.66667 70.66667 70.66667 71.25000 71.25000 71.25000\n[1321] 71.25000 69.08333 69.08333 69.08333 69.08333 69.08333 67.83333 67.83333\n[1329] 67.83333 67.83333 65.08333 65.08333 65.08333 65.08333 62.66667 62.66667\n[1337] 62.66667 67.83333 67.83333 67.83333 67.83333 67.75000 67.75000 67.75000\n[1345] 67.75000 65.83333 65.83333 65.83333 65.83333 66.25000 66.25000 66.25000\n[1353] 66.25000 66.25000 67.75000 67.75000 67.75000 67.75000 66.33333 66.33333\n[1361] 66.33333 66.33333 67.50000 67.50000 67.50000 67.50000 68.41667 68.41667\n[1369] 68.41667 68.41667 68.41667 67.58333 67.58333 67.58333 67.58333 68.08333\n[1377] 68.08333 68.08333 68.08333 70.25000 70.25000 70.25000 70.25000 68.41667\n[1385] 68.41667 68.41667 68.41667 68.41667 65.75000 65.75000 65.75000 65.75000\n[1393] 63.00000 63.00000 63.00000 63.00000 61.50000 61.50000 66.50000 67.83333\n[1401] 67.83333 67.83333 67.83333 67.75000 67.75000 67.75000 67.75000 65.83333\n[1409] 65.83333 65.83333 65.83333 66.25000 66.25000 66.25000 66.25000 66.25000\n[1417] 67.75000 67.75000 67.75000 67.75000 66.33333 66.33333 66.33333 66.33333\n[1425] 67.50000 67.50000 67.50000 67.50000 68.41667 68.41667 68.41667 68.41667\n[1433] 68.41667 67.58333 67.58333 67.58333 67.58333 68.08333 68.08333 68.08333\n[1441] 68.08333 70.25000 70.25000 70.25000 70.25000 68.41667 68.41667 68.41667\n[1449] 68.41667 68.41667 65.75000 65.75000 65.75000 65.75000 63.00000 63.00000\n[1457] 63.00000 63.00000 61.50000 61.50000 66.50000 67.83333 67.83333 67.83333\n[1465] 67.83333 67.75000 67.75000 67.75000 67.75000 65.83333 65.83333 65.83333\n[1473] 65.83333 66.25000 66.25000 66.25000 66.25000 66.25000 67.75000 67.75000\n[1481] 67.75000 67.75000 66.33333 66.33333 66.33333 66.33333 67.50000 67.50000\n[1489] 67.50000 67.50000 68.41667 68.41667 68.41667 68.41667 68.41667 67.58333\n[1497] 67.58333 67.58333 67.58333 68.08333 68.08333 68.08333 68.08333 70.25000\n[1505] 70.25000 70.25000 70.25000 68.41667 68.41667 68.41667 68.41667 68.41667\n[1513] 65.75000 65.75000 65.75000 65.75000 63.00000 63.00000 63.00000 63.00000\n[1521] 61.50000 61.50000 66.50000 67.83333 67.83333 67.83333 67.83333 67.75000\n[1529] 67.75000 67.75000 67.75000 65.83333 65.83333 65.83333 65.83333 66.25000\n[1537] 66.25000 66.25000 66.25000 66.25000 67.75000 67.75000 67.75000 67.75000\n[1545] 66.33333 66.33333 66.33333 66.33333 67.50000 67.50000 67.50000 67.50000\n[1553] 68.41667 68.41667 68.41667 68.41667 68.41667 67.58333 67.58333 67.58333\n[1561] 67.58333 68.08333 68.08333 68.08333 68.08333 70.25000 70.25000 70.25000\n[1569] 70.25000 68.41667 68.41667 68.41667 68.41667 68.41667 65.75000 65.75000\n[1577] 65.75000 65.75000 63.00000 63.00000 63.00000 63.00000 61.50000 61.50000\n[1585] 66.50000 67.83333 67.83333 67.83333 67.83333 67.75000 67.75000 67.75000\n[1593] 67.75000 65.83333 65.83333 65.83333 65.83333 66.25000 66.25000 66.25000\n[1601] 66.25000 66.25000 67.75000 67.75000 67.75000 67.75000 66.33333 66.33333\n[1609] 66.33333 66.33333 67.50000 67.50000 67.50000 67.50000 68.41667 68.41667\n[1617] 68.41667 68.41667 68.41667 67.58333 67.58333 67.58333 67.58333 68.08333\n[1625] 68.08333 68.08333 68.08333 70.25000 70.25000 70.25000 70.25000 68.41667\n[1633] 68.41667 68.41667 68.41667 68.41667 65.75000 65.75000 65.75000 65.75000\n[1641] 63.00000 63.00000 63.00000 63.00000 61.50000 61.50000 66.50000 66.50000\n[1649] 67.83333 67.83333 67.83333 67.83333 67.75000 67.75000 67.75000 67.75000\n[1657] 65.83333 65.83333 65.83333 65.83333 66.25000 66.25000 66.25000 66.25000\n[1665] 66.25000 67.75000 67.75000 67.75000 67.75000 66.33333 66.33333 66.33333\n[1673] 66.33333 67.50000 67.50000 67.50000 67.50000 68.41667 68.41667 68.41667\n[1681] 68.41667 68.41667 67.58333 67.58333 67.58333 67.58333 68.08333 68.08333\n[1689] 68.08333 68.08333 70.25000 70.25000 70.25000 70.25000 68.41667 68.41667\n[1697] 68.41667 68.41667 68.41667 65.75000 65.75000 65.75000 65.75000 63.00000\n[1705] 63.00000 63.00000 63.00000 61.50000 61.50000 69.08333 69.08333 68.58333\n[1713] 68.58333 68.58333 68.58333 68.75000 68.75000 68.75000 68.75000 67.41667\n[1721] 67.41667 67.41667 67.41667 67.08333 67.08333 67.08333 67.08333 67.08333\n[1729] 66.91667 66.91667 66.91667 66.91667 65.50000 65.50000 65.50000 65.50000\n[1737] 66.16667 66.16667 66.16667 66.16667 67.16667 67.16667 67.16667 67.16667\n[1745] 67.16667 67.08333 67.08333 67.08333 67.08333 66.50000 66.50000 66.50000\n[1753] 66.50000 66.58333 66.58333 66.58333 66.58333 65.41667 65.41667 65.41667\n[1761] 65.41667 65.41667 63.91667 63.91667 63.91667 63.91667 62.41667 62.41667\n[1769] 62.41667 62.41667 63.00000 63.00000 69.08333 69.08333 68.58333 68.58333\n[1777] 68.58333 68.58333 68.75000 68.75000 68.75000 68.75000 67.41667 67.41667\n[1785] 67.41667 67.41667 67.08333 67.08333 67.08333 67.08333 67.08333 66.91667\n[1793] 66.91667 66.91667 66.91667 65.50000 65.50000 65.50000 65.50000 66.16667\n[1801] 66.16667 66.16667 66.16667 67.16667 67.16667 67.16667 67.16667 67.16667\n[1809] 67.08333 67.08333 67.08333 67.08333 66.50000 66.50000 66.50000 66.50000\n[1817] 66.58333 66.58333 66.58333 66.58333 65.41667 65.41667 65.41667 65.41667\n[1825] 65.41667 63.91667 69.08333 69.08333 68.58333 68.58333 68.58333 68.58333\n[1833] 68.75000 68.75000 68.75000 68.75000 67.41667 67.41667 67.41667 67.41667\n[1841] 67.08333 67.08333 67.08333 67.08333 67.08333 66.91667 66.91667 66.91667\n[1849] 66.91667 65.50000 65.50000 65.50000 65.50000 66.16667 66.16667 66.16667\n[1857] 66.16667 67.16667 67.16667 67.16667 67.16667 67.16667 67.08333 67.08333\n[1865] 67.08333 67.08333 66.50000 66.50000 66.50000 66.50000 66.58333 66.58333\n[1873] 66.58333 66.58333 65.41667 65.41667 65.41667 65.41667 65.41667 63.91667\n[1881] 69.08333 69.08333 68.58333 68.58333 68.58333 68.58333 68.75000 68.75000\n[1889] 68.75000 68.75000 67.41667 67.41667 67.41667 67.41667 67.08333 67.08333\n[1897] 67.08333 67.08333 67.08333 66.91667 66.91667 66.91667 66.91667 65.50000\n[1905] 65.50000 65.50000 65.50000 66.16667 66.16667 66.16667 66.16667 67.16667\n[1913] 67.16667 67.16667 67.16667 67.16667 67.08333 67.08333 67.08333 67.08333\n[1921] 66.50000 66.50000 66.50000 66.50000 66.58333 66.58333 66.58333 66.58333\n[1929] 65.41667 65.41667 65.41667 65.41667 65.41667 63.91667 63.91667 69.08333\n[1937] 69.08333 68.58333 68.58333 68.58333 68.58333 68.75000 68.75000 68.75000\n[1945] 68.75000 67.41667 67.41667 67.41667 67.41667 67.08333 67.08333 67.08333\n[1953] 67.08333 67.08333 66.91667 66.91667 66.91667 66.91667 65.50000 65.50000\n[1961] 65.50000 65.50000 66.16667 66.16667 66.16667 66.16667 67.16667 67.16667\n[1969] 67.16667 67.16667 67.16667 67.08333 67.08333 67.08333 67.08333 66.50000\n[1977] 66.50000 66.50000 66.50000 66.58333 66.58333 66.58333 66.58333 65.41667\n[1985] 65.41667 65.41667 65.41667 65.41667 69.08333 69.08333 69.08333 68.58333\n[1993] 68.58333 68.58333 68.58333 68.75000 68.75000 68.75000 68.75000 67.41667\n[2001] 67.41667 67.41667 67.41667 67.08333 67.08333 67.08333 67.08333 67.08333\n[2009] 66.91667 66.91667 66.91667 66.91667 65.50000 65.50000 65.50000 65.50000\n[2017] 66.16667 66.16667 66.16667 66.16667 67.16667 67.16667 67.16667 67.16667\n[2025] 67.16667 67.08333 67.08333 67.08333 67.08333 66.50000 66.50000 66.50000\n[2033] 66.50000 66.58333 66.58333 66.58333 66.58333 65.41667 65.41667 65.41667\n[2041] 65.41667 65.41667 63.91667 69.00000 69.00000 69.00000 69.16667 69.16667\n[2049] 69.16667 69.16667 70.66667 70.66667 70.66667 70.66667 68.83333 68.83333\n[2057] 68.83333 68.83333 66.41667 66.41667 66.41667 66.41667 66.41667 65.08333\n[2065] 65.08333 65.08333 65.08333 66.66667 66.66667 66.66667 66.66667 66.58333\n[2073] 66.58333 66.58333 66.58333 66.75000 66.75000 66.75000 66.75000 66.75000\n[2081] 68.41667 68.41667 68.41667 68.41667 66.58333 66.58333 66.58333 66.58333\n[2089] 65.91667 65.91667 65.91667 65.91667 65.00000 65.00000 65.00000 65.00000\n[2097] 65.00000 69.00000 69.00000 69.00000 69.00000 69.16667 69.16667 69.16667\n[2105] 69.16667 70.66667 70.66667 70.66667 70.66667 68.83333 68.83333 68.83333\n[2113] 68.83333 66.41667 66.41667 66.41667 66.41667 66.41667 65.08333 65.08333\n[2121] 65.08333 65.08333 66.66667 66.66667 66.66667 66.66667 66.58333 66.58333\n[2129] 66.58333 66.58333 66.75000 66.75000 66.75000 66.75000 66.75000 68.41667\n[2137] 68.41667 68.41667 68.41667 66.58333 66.58333 66.58333 66.58333 65.91667\n[2145] 65.91667 65.91667 65.91667 65.00000 65.00000 65.00000 65.00000 65.00000\n[2153] 64.50000 64.50000 69.00000 69.00000 69.00000 69.00000 69.16667 69.16667\n[2161] 69.16667 69.16667 70.66667 70.66667 70.66667 70.66667 68.83333 68.83333\n[2169] 68.83333 68.83333 66.41667 66.41667 66.41667 66.41667 66.41667 65.08333\n[2177] 65.08333 65.08333 65.08333 66.66667 66.66667 66.66667 66.66667 66.58333\n[2185] 66.58333 66.58333 66.58333 66.75000 66.75000 66.75000 66.75000 66.75000\n[2193] 68.41667 68.41667 68.41667 68.41667 66.58333 66.58333 66.58333 66.58333\n[2201] 65.91667 65.91667 65.91667 65.91667 65.00000 65.00000 65.00000 65.00000\n[2209] 65.00000 64.50000 64.50000 64.50000 64.50000 64.75000 64.75000 64.75000\n[2217] 64.75000 69.00000 69.00000 69.00000 69.00000 69.16667 69.16667 69.16667\n[2225] 69.16667 70.66667 70.66667 70.66667 70.66667 68.83333 68.83333 68.83333\n[2233] 68.83333 66.41667 66.41667 66.41667 66.41667 66.41667 65.08333 65.08333\n[2241] 65.08333 65.08333 66.66667 66.66667 66.66667 66.66667 66.58333 66.58333\n[2249] 66.58333 66.58333 66.75000 66.75000 66.75000 66.75000 66.75000 68.41667\n[2257] 68.41667 68.41667 68.41667 66.58333 66.58333 66.58333 66.58333 65.91667\n[2265] 65.91667 65.91667 65.91667 65.00000 65.00000 65.00000 65.00000 65.00000\n[2273] 64.50000 64.50000 64.50000 64.50000 64.75000 64.75000 64.75000 64.75000\n[2281] 65.25000 69.00000 69.00000 69.00000 69.00000 69.16667 69.16667 69.16667\n[2289] 69.16667 70.66667 70.66667 70.66667 70.66667 68.83333 68.83333 68.83333\n[2297] 68.83333 66.41667 66.41667 66.41667 66.41667 66.41667 65.08333 65.08333\n[2305] 65.08333 65.08333 66.66667 66.66667 66.66667 66.66667 66.58333 66.58333\n[2313] 66.58333 66.58333 66.75000 66.75000 66.75000 66.75000 66.75000 68.41667\n[2321] 68.41667 68.41667 68.41667 66.58333 66.58333 66.58333 66.58333 65.91667\n[2329] 65.91667 65.91667 65.91667 65.00000 65.00000 65.00000 65.00000 65.00000\n[2337] 64.50000 64.50000 64.50000 64.50000 64.75000 64.75000 64.75000 64.75000\n[2345] 65.25000 65.25000 69.00000 69.00000 69.00000 69.00000 69.00000 69.16667\n[2353] 69.16667 69.16667 69.16667 70.66667 70.66667 70.66667 70.66667 68.83333\n[2361] 68.83333 68.83333 68.83333 66.41667 66.41667 66.41667 66.41667 66.41667\n[2369] 65.08333 65.08333 65.08333 65.08333 66.66667 66.66667 66.66667 66.66667\n[2377] 66.58333 66.58333 66.58333 66.58333 66.75000 66.75000 66.75000 66.75000\n[2385] 66.75000 68.41667 68.41667 68.41667 68.41667 66.58333 66.58333 66.58333\n[2393] 66.58333 65.91667 65.91667 65.91667 65.91667 65.00000 65.00000 65.00000\n[2401] 65.00000 65.00000 64.50000 64.50000 64.50000 64.50000 64.75000 64.75000\n[2409] 64.75000 64.75000 65.25000 65.25000 68.66667 68.66667 68.66667 68.66667\n[2417] 68.66667 69.41667 69.41667 69.41667 69.41667 68.83333 68.83333 68.83333\n[2425] 68.83333 68.50000 68.50000 68.50000 68.50000 68.91667 68.91667 68.91667\n[2433] 68.91667 68.91667 66.41667 66.41667 66.41667 66.41667 68.25000 68.25000\n[2441] 68.25000 68.25000 72.00000 72.00000 72.00000 72.00000 73.00000 73.00000\n[2449] 73.00000 73.00000 73.00000 69.58333 69.58333 69.58333 69.58333 65.66667\n[2457] 65.66667 65.66667 65.66667 66.08333 66.08333 66.08333 66.08333 65.91667\n[2465] 65.91667 65.91667 65.91667 65.91667 64.75000 64.75000 64.75000 64.75000\n[2473] 64.66667 64.66667 64.66667 64.66667 64.58333 68.00000 68.66667 68.66667\n[2481] 68.66667 68.66667 68.66667 69.41667 69.41667 69.41667 69.41667 68.83333\n[2489] 68.83333 68.83333 68.83333 68.50000 68.50000 68.50000 68.50000 68.91667\n[2497] 68.91667 68.91667 68.91667 68.91667 66.41667 66.41667 66.41667 66.41667\n[2505] 68.25000 68.25000 68.25000 68.25000 72.00000 72.00000 72.00000 72.00000\n[2513] 73.00000 73.00000 73.00000 73.00000 73.00000 69.58333 69.58333 69.58333\n[2521] 69.58333 65.66667 65.66667 65.66667 65.66667 66.08333 66.08333 66.08333\n[2529] 66.08333 65.91667 65.91667 65.91667 65.91667 65.91667 64.75000 64.75000\n[2537] 64.75000 64.75000 64.66667 64.66667 64.66667 64.66667 64.58333 68.00000\n[2545] 68.00000 68.66667 68.66667 68.66667 68.66667 68.66667 69.41667 69.41667\n[2553] 69.41667 69.41667 68.83333 68.83333 68.83333 68.83333 68.50000 68.50000\n[2561] 68.50000 68.50000 68.91667 68.91667 68.91667 68.91667 68.91667 66.41667\n[2569] 66.41667 66.41667 66.41667 68.25000 68.25000 68.25000 68.25000 72.00000\n[2577] 72.00000 72.00000 72.00000 73.00000 73.00000 73.00000 73.00000 73.00000\n[2585] 69.58333 69.58333 69.58333 69.58333 65.66667 65.66667 65.66667 65.66667\n[2593] 66.08333 66.08333 66.08333 66.08333 65.91667 65.91667 65.91667 65.91667\n[2601] 65.91667 64.75000 64.75000 64.75000 64.75000 64.66667 64.66667 64.66667\n[2609] 64.66667 64.58333 68.00000 68.00000 68.66667 68.66667 68.66667 68.66667\n[2617] 68.66667 69.41667 69.41667 69.41667 69.41667 68.83333 68.83333 68.83333\n[2625] 68.83333 68.50000 68.50000 68.50000 68.50000 68.91667 68.91667 68.91667\n[2633] 68.91667 68.91667 66.41667 66.41667 66.41667 66.41667 68.25000 68.25000\n[2641] 68.25000 68.25000 72.00000 72.00000 72.00000 72.00000 73.00000 73.00000\n[2649] 73.00000 73.00000 73.00000 69.58333 69.58333 69.58333 69.58333 65.66667\n[2657] 65.66667 65.66667 65.66667 66.08333 66.08333 66.08333 66.08333 65.91667\n[2665] 65.91667 65.91667 65.91667 65.91667 64.75000 64.75000 64.75000 64.75000\n[2673] 64.66667 64.66667 64.66667 64.66667 64.58333 64.58333 68.00000 68.00000\n[2681] 68.00000 68.66667 68.66667 68.66667 68.66667 68.66667 69.41667 69.41667\n[2689] 69.41667 69.41667 68.83333 68.83333 68.83333 68.83333 68.50000 68.50000\n[2697] 68.50000 68.50000 68.91667 68.91667 68.91667 68.91667 68.91667 66.41667\n[2705] 66.41667 66.41667 66.41667 68.25000 68.25000 68.25000 68.25000 72.00000\n[2713] 72.00000 72.00000 72.00000 73.00000 73.00000 73.00000 73.00000 73.00000\n[2721] 69.58333 69.58333 69.58333 69.58333 65.66667 65.66667 65.66667 65.66667\n[2729] 66.08333 66.08333 66.08333 66.08333 65.91667 65.91667 65.91667 65.91667\n[2737] 65.91667 64.75000 64.75000 64.75000 64.75000 64.66667 64.66667 64.66667\n[2745] 64.66667 68.00000 68.00000 68.00000 68.00000 68.66667 68.66667 68.66667\n[2753] 68.66667 68.66667 69.41667 69.41667 69.41667 69.41667 68.83333 68.83333\n[2761] 68.83333 68.83333 68.50000 68.50000 68.50000 68.50000 68.91667 68.91667\n[2769] 68.91667 68.91667 68.91667 66.41667 66.41667 66.41667 66.41667 68.25000\n[2777] 68.25000 68.25000 68.25000 72.00000 72.00000 72.00000 72.00000 73.00000\n[2785] 73.00000 73.00000 73.00000 73.00000 69.58333 69.58333 69.58333 69.58333\n[2793] 65.66667 65.66667 65.66667 65.66667 66.08333 66.08333 66.08333 66.08333\n[2801] 65.91667 65.91667 65.91667 65.91667 65.91667 64.75000 64.75000 64.75000\n[2809] 64.75000 64.66667 64.66667 70.75000 70.75000 70.75000 70.75000 70.16667\n[2817] 70.16667 70.16667 70.16667 70.16667 68.66667 68.66667 68.66667 68.66667\n[2825] 66.58333 66.58333 66.58333 66.58333 66.41667 66.41667 66.41667 66.41667\n[2833] 67.91667 67.91667 67.91667 67.91667 67.91667 69.66667 69.66667 69.66667\n[2841] 69.66667 68.08333 68.08333 68.08333 68.08333 70.08333 70.08333 70.08333\n[2849] 70.08333 72.00000 72.00000 72.00000 72.00000 72.00000 68.08333 68.08333\n[2857] 68.08333 68.08333 65.75000 65.75000 65.75000 65.75000 64.83333 64.83333\n[2865] 64.83333 64.83333 64.66667 64.66667 64.66667 64.66667 64.66667 64.41667\n[2873] 64.41667 64.41667 64.41667 65.25000 69.75000 69.75000 70.75000 70.75000\n[2881] 70.75000 70.75000 70.16667 70.16667 70.16667 70.16667 70.16667 68.66667\n[2889] 68.66667 68.66667 68.66667 66.58333 66.58333 66.58333 66.58333 66.41667\n[2897] 66.41667 66.41667 66.41667 67.91667 67.91667 67.91667 67.91667 67.91667\n[2905] 69.66667 69.66667 69.66667 69.66667 68.08333 68.08333 68.08333 68.08333\n[2913] 70.08333 70.08333 70.08333 70.08333 72.00000 72.00000 72.00000 72.00000\n[2921] 72.00000 68.08333 68.08333 68.08333 68.08333 65.75000 65.75000 65.75000\n[2929] 65.75000 64.83333 64.83333 64.83333 64.83333 64.66667 64.66667 64.66667\n[2937] 64.66667 64.66667 64.41667 64.41667 64.41667 64.41667 65.25000 69.75000\n[2945] 69.75000 69.75000 70.75000 70.75000 70.75000 70.75000 70.16667 70.16667\n[2953] 70.16667 70.16667 70.16667 68.66667 68.66667 68.66667 68.66667 66.58333\n[2961] 66.58333 66.58333 66.58333 66.41667 66.41667 66.41667 66.41667 67.91667\n[2969] 67.91667 67.91667 67.91667 67.91667 69.66667 69.66667 69.66667 69.66667\n[2977] 68.08333 68.08333 68.08333 68.08333 70.08333 70.08333 70.08333 70.08333\n[2985] 72.00000 72.00000 72.00000 72.00000 72.00000 68.08333 68.08333 68.08333\n[2993] 68.08333 65.75000 65.75000 65.75000 65.75000 64.83333 64.83333 64.83333\n[3001] 64.83333 64.66667 64.66667 64.66667 64.66667 64.66667 64.41667 64.41667\n[3009] 69.75000 69.75000 69.75000 69.75000 70.75000 70.75000 70.75000 70.75000\n[3017] 70.16667 70.16667 70.16667 70.16667 70.16667 68.66667 68.66667 68.66667\n[3025] 68.66667 66.58333 66.58333 66.58333 66.58333 66.41667 66.41667 66.41667\n[3033] 66.41667 67.91667 67.91667 67.91667 67.91667 67.91667 69.66667 69.66667\n[3041] 69.66667 69.66667 68.08333 68.08333 68.08333 68.08333 70.08333 70.08333\n[3049] 70.08333 70.08333 72.00000 72.00000 72.00000 72.00000 72.00000 68.08333\n[3057] 68.08333 68.08333 68.08333 65.75000 65.75000 65.75000 65.75000 64.83333\n[3065] 64.83333 64.83333 64.83333 64.66667 64.66667 64.66667 64.66667 64.66667\n[3073] 68.41667 69.75000 69.75000 69.75000 69.75000 70.75000 70.75000 70.75000\n[3081] 70.75000 70.16667 70.16667 70.16667 70.16667 70.16667 68.66667 68.66667\n[3089] 68.66667 68.66667 66.58333 66.58333 66.58333 66.58333 66.41667 66.41667\n[3097] 66.41667 66.41667 67.91667 67.91667 67.91667 67.91667 67.91667 69.66667\n[3105] 69.66667 69.66667 69.66667 68.08333 68.08333 68.08333 68.08333 70.08333\n[3113] 70.08333 70.08333 70.08333 72.00000 72.00000 72.00000 72.00000 72.00000\n[3121] 68.08333 68.08333 68.08333 68.08333 65.75000 65.75000 65.75000 65.75000\n[3129] 64.83333 64.83333 64.83333 64.83333 64.66667 64.66667 64.66667 64.66667\n[3137] 64.66667 64.41667 68.41667 69.75000 69.75000 69.75000 69.75000 70.75000\n[3145] 70.75000 70.75000 70.75000 70.16667 70.16667 70.16667 70.16667 70.16667\n[3153] 68.66667 68.66667 68.66667 68.66667 66.58333 66.58333 66.58333 66.58333\n[3161] 66.41667 66.41667 66.41667 66.41667 67.91667 67.91667 67.91667 67.91667\n[3169] 67.91667 69.66667 69.66667 69.66667 69.66667 68.08333 68.08333 68.08333\n[3177] 68.08333 70.08333 70.08333 70.08333 70.08333 72.00000 72.00000 72.00000\n[3185] 72.00000 72.00000 68.08333 68.08333 68.08333 68.08333 65.75000 65.75000\n[3193] 65.75000 65.75000 64.83333 64.83333 64.83333 64.83333 64.66667 64.66667\n[3201] 64.66667 64.66667 64.66667 64.41667 64.41667 64.41667 65.58333 65.58333\n[3209] 67.50000 67.50000 67.50000 67.50000 69.33333 69.33333 69.33333 69.33333\n[3217] 71.91667 71.91667 71.91667 71.91667 71.50000 71.50000 71.50000 71.50000\n[3225] 71.50000 68.16667 68.16667 68.16667 68.16667 66.66667 66.66667 66.66667\n[3233] 66.66667 64.66667 64.66667 64.66667 64.66667 63.41667 63.41667 63.41667\n[3241] 63.41667 63.41667 65.00000 65.00000 65.00000 65.00000 65.91667 65.91667\n[3249] 65.91667 65.91667 66.58333 66.58333 66.58333 66.58333 65.91667 65.91667\n[3257] 65.91667 65.91667 65.91667 63.83333 63.83333 63.83333 63.83333 63.41667\n[3265] 63.41667 63.41667 63.41667 61.83333 61.83333 61.83333 61.83333 64.25000\n[3273] 64.25000 64.25000 64.25000 64.25000 66.58333 66.58333 66.58333 66.58333\n[3281] 65.58333 65.58333 67.50000 67.50000 67.50000 67.50000 69.33333 69.33333\n[3289] 69.33333 69.33333 71.91667 71.91667 71.91667 71.91667 71.50000 71.50000\n[3297] 71.50000 71.50000 71.50000 68.16667 68.16667 68.16667 68.16667 66.66667\n[3305] 66.66667 66.66667 66.66667 64.66667 64.66667 64.66667 64.66667 63.41667\n[3313] 63.41667 63.41667 63.41667 63.41667 65.00000 65.00000 65.00000 65.00000\n[3321] 65.91667 65.91667 65.91667 65.91667 66.58333 66.58333 66.58333 66.58333\n[3329] 65.91667 65.91667 65.91667 65.91667 65.91667 63.83333 63.83333 63.83333\n[3337] 63.83333 63.41667 63.41667 63.41667 63.41667 61.83333 61.83333 61.83333\n[3345] 61.83333 64.25000 64.25000 64.25000 64.25000 64.25000 66.58333 66.58333\n[3353] 66.58333 65.58333 65.58333 67.50000 67.50000 67.50000 67.50000 69.33333\n[3361] 69.33333 69.33333 69.33333 71.91667 71.91667 71.91667 71.91667 71.50000\n[3369] 71.50000 71.50000 71.50000 71.50000 68.16667 68.16667 68.16667 68.16667\n[3377] 66.66667 66.66667 66.66667 66.66667 64.66667 64.66667 64.66667 64.66667\n[3385] 63.41667 63.41667 63.41667 63.41667 63.41667 65.00000 65.00000 65.00000\n[3393] 65.00000 65.91667 65.91667 65.91667 65.91667 66.58333 66.58333 66.58333\n[3401] 66.58333 65.91667 65.91667 65.91667 65.91667 65.91667 63.83333 63.83333\n[3409] 63.83333 63.83333 63.41667 63.41667 63.41667 63.41667 61.83333 61.83333\n[3417] 61.83333 61.83333 64.25000 64.25000 64.25000 64.25000 64.25000 66.58333\n[3425] 66.58333 66.58333 65.58333 67.50000 67.50000 67.50000 67.50000 69.33333\n[3433] 69.33333 69.33333 69.33333 71.91667 71.91667 71.91667 71.91667 71.50000\n[3441] 71.50000 71.50000 71.50000 71.50000 68.16667 68.16667 68.16667 68.16667\n[3449] 66.66667 66.66667 66.66667 66.66667 64.66667 64.66667 64.66667 64.66667\n[3457] 63.41667 63.41667 63.41667 63.41667 63.41667 65.00000 65.00000 65.00000\n[3465] 65.00000 65.91667 65.91667 65.91667 65.91667 66.58333 66.58333 66.58333\n[3473] 66.58333 65.91667 65.91667 65.91667 65.91667 65.91667 63.83333 63.83333\n[3481] 63.41667 63.41667 63.41667 63.41667 61.83333 61.83333 61.83333 61.83333\n[3489] 64.25000 64.25000 64.25000 65.58333 67.50000 67.50000 67.50000 67.50000\n[3497] 69.33333 69.33333 69.33333 69.33333 71.91667 71.91667 71.91667 71.91667\n[3505] 71.50000 71.50000 71.50000 71.50000 71.50000 68.16667 68.16667 68.16667\n[3513] 68.16667 66.66667 66.66667 66.66667 66.66667 64.66667 64.66667 64.66667\n[3521] 64.66667 63.41667 63.41667 63.41667 63.41667 63.41667 65.00000 65.00000\n[3529] 65.00000 65.00000 65.91667 65.91667 65.91667 65.91667 66.58333 66.58333\n[3537] 66.58333 66.58333 65.91667 65.91667 65.91667 65.91667 65.91667 63.83333\n[3545] 63.83333 63.83333 63.41667 61.83333 61.83333 61.83333 61.83333 65.58333\n[3553] 65.58333 65.58333 67.50000 67.50000 67.50000 67.50000 69.33333 69.33333\n[3561] 69.33333 69.33333 71.91667 71.91667 71.91667 71.91667 71.50000 71.50000\n[3569] 71.50000 71.50000 71.50000 68.16667 68.16667 68.16667 68.16667 66.66667\n[3577] 66.66667 66.66667 66.66667 64.66667 64.66667 64.66667 64.66667 63.41667\n[3585] 63.41667 63.41667 63.41667 63.41667 65.00000 65.00000 65.00000 65.00000\n[3593] 65.91667 65.91667 65.91667 65.91667 66.58333 66.58333 66.58333 66.58333\n[3601] 65.91667 65.91667 65.91667 65.91667 65.91667 61.83333 62.33333 62.33333\n[3609] 62.33333 62.33333 62.33333 65.58333 65.58333 65.58333 65.58333 67.25000\n[3617] 67.25000 67.25000 67.25000 67.66667 67.66667 67.66667 67.66667 68.00000\n[3625] 68.00000 68.00000 68.00000 68.00000 67.16667 67.16667 67.16667 67.16667\n[3633] 66.16667 66.16667 66.16667 66.16667 65.25000 65.25000 65.25000 65.25000\n[3641] 64.66667 64.66667 64.66667 64.66667 64.66667 64.66667 64.66667 64.66667\n[3649] 64.66667 62.91667 62.91667 62.91667 62.91667 63.33333 63.33333 63.33333\n[3657] 63.33333 63.16667 63.16667 63.16667 63.16667 62.83333 62.33333 62.33333\n[3665] 62.33333 62.33333 62.33333 65.58333 65.58333 65.58333 65.58333 67.25000\n[3673] 67.25000 67.25000 67.25000 67.66667 67.66667 67.66667 67.66667 68.00000\n[3681] 68.00000 68.00000 68.00000 68.00000 67.16667 67.16667 67.16667 67.16667\n[3689] 66.16667 66.16667 66.16667 66.16667 65.25000 65.25000 65.25000 65.25000\n[3697] 64.66667 64.66667 64.66667 64.66667 64.66667 64.66667 64.66667 64.66667\n[3705] 64.66667 62.91667 62.91667 62.91667 62.91667 63.33333 63.33333 63.33333\n[3713] 63.33333 63.16667 63.16667 63.16667 63.16667 62.83333 62.83333 62.33333\n[3721] 62.33333 62.33333 62.33333 62.33333 65.58333 65.58333 65.58333 65.58333\n[3729] 67.25000 67.25000 67.25000 67.25000 67.66667 67.66667 67.66667 67.66667\n[3737] 68.00000 68.00000 68.00000 68.00000 68.00000 67.16667 67.16667 67.16667\n[3745] 67.16667 66.16667 66.16667 66.16667 66.16667 65.25000 65.25000 65.25000\n[3753] 65.25000 64.66667 64.66667 64.66667 64.66667 64.66667 64.66667 64.66667\n[3761] 64.66667 64.66667 62.91667 62.91667 62.91667 62.91667 63.33333 63.33333\n[3769] 63.33333 63.33333 63.16667 63.16667 63.16667 63.16667 62.83333 62.83333\n[3777] 62.83333 62.83333 62.33333 62.33333 62.33333 62.33333 62.33333 65.58333\n[3785] 65.58333 65.58333 65.58333 67.25000 67.25000 67.25000 67.25000 67.66667\n[3793] 67.66667 67.66667 67.66667 68.00000 68.00000 68.00000 68.00000 68.00000\n[3801] 67.16667 67.16667 67.16667 67.16667 66.16667 66.16667 66.16667 66.16667\n[3809] 65.25000 65.25000 65.25000 65.25000 64.66667 64.66667 64.66667 64.66667\n[3817] 64.66667 64.66667 64.66667 64.66667 64.66667 62.91667 62.91667 62.91667\n[3825] 62.91667 63.33333 63.33333 63.33333 63.33333 63.16667 63.16667 63.16667\n[3833] 63.16667 63.16667 62.83333 62.83333 62.83333 62.83333 62.33333 62.33333\n[3841] 62.33333 62.33333 62.33333 65.58333 65.58333 65.58333 65.58333 67.25000\n[3849] 67.25000 67.25000 67.25000 67.66667 67.66667 67.66667 67.66667 68.00000\n[3857] 68.00000 68.00000 68.00000 68.00000 67.16667 67.16667 67.16667 67.16667\n[3865] 66.16667 66.16667 66.16667 66.16667 65.25000 65.25000 65.25000 65.25000\n[3873] 64.66667 64.66667 64.66667 64.66667 64.66667 64.66667 64.66667 64.66667\n[3881] 64.66667 62.91667 62.91667 62.91667 62.91667 63.33333 63.33333 63.33333\n[3889] 63.33333 63.16667 63.16667 63.16667 63.16667 63.16667       NA 62.83333\n[3897] 62.83333 62.83333 62.83333 62.33333 62.33333 62.33333 62.33333 62.33333\n[3905] 65.58333 65.58333 65.58333 65.58333 67.25000 67.25000 67.25000 67.25000\n[3913] 67.66667 67.66667 67.66667 67.66667 68.00000 68.00000 68.00000 68.00000\n[3921] 68.00000 67.16667 67.16667 67.16667 67.16667 66.16667 66.16667 66.16667\n[3929] 66.16667 65.25000 65.25000 65.25000 65.25000 64.66667 64.66667 64.66667\n[3937] 64.66667 64.66667 64.66667 64.66667 64.66667 64.66667 62.91667 62.91667\n[3945] 62.91667 62.91667 63.33333 63.33333 63.33333 63.33333 63.16667 63.16667\n[3953] 63.16667 63.16667 63.16667 62.50000 63.91667 64.00000 64.00000 64.00000\n[3961] 64.00000 64.91667 64.91667 64.91667 64.91667 64.91667 65.91667 65.91667\n[3969] 65.91667 65.91667 65.83333 65.83333 65.83333 65.83333 65.91667 65.91667\n[3977] 65.91667 65.91667 67.00000 67.00000 67.00000 67.00000 67.00000 67.91667\n[3985] 67.91667 67.91667 67.91667 66.58333 66.58333 66.58333 66.58333 66.16667\n[3993] 66.16667 66.16667 66.16667 64.41667 64.41667 64.41667 64.41667 64.41667\n[4001] 63.91667 63.91667 63.91667 63.91667 62.83333 62.83333 62.83333 62.83333\n[4009] 62.58333 62.58333 62.58333 62.58333 62.83333 62.83333 62.83333 62.83333\n[4017] 62.83333 61.50000 61.50000 61.41667 63.91667 63.91667 64.00000 64.00000\n[4025] 64.00000 64.00000 64.91667 64.91667 64.91667 64.91667 64.91667 65.91667\n[4033] 65.91667 65.91667 65.91667 65.83333 65.83333 65.83333 65.83333 65.91667\n[4041] 65.91667 65.91667 65.91667 67.00000 67.00000 67.00000 67.00000 67.00000\n[4049] 67.91667 67.91667 67.91667 67.91667 66.58333 66.58333 66.58333 66.58333\n[4057] 66.16667 66.16667 66.16667 66.16667 64.41667 64.41667 64.41667 64.41667\n[4065] 64.41667 63.91667 63.91667 63.91667 63.91667 62.83333 62.83333 62.83333\n[4073] 62.83333 62.58333 62.58333 62.58333 62.58333 62.83333 62.83333 62.83333\n[4081] 62.83333 62.83333 61.50000 61.50000 61.41667 61.41667 63.91667 63.91667\n[4089] 63.91667 63.91667 64.00000 64.00000 64.00000 64.00000 64.91667 64.91667\n[4097] 64.91667 64.91667 64.91667 65.91667 65.91667 65.91667 65.91667 65.83333\n[4105] 65.83333 65.83333 65.83333 65.91667 65.91667 65.91667 65.91667 67.00000\n[4113] 67.00000 67.00000 67.00000 67.00000 67.91667 67.91667 67.91667 67.91667\n[4121] 66.58333 66.58333 66.58333 66.58333 66.16667 66.16667 66.16667 66.16667\n[4129] 64.41667 64.41667 64.41667 64.41667 64.41667 63.91667 63.91667 63.91667\n[4137] 63.91667 62.83333 62.83333 62.83333 62.83333 62.58333 62.58333 62.58333\n[4145] 62.58333 62.83333 62.83333 62.83333 62.83333 62.83333 61.50000 61.50000\n[4153] 61.50000 61.41667 61.41667 61.41667 63.91667 63.91667 63.91667 63.91667\n[4161] 64.00000 64.00000 64.00000 64.00000 64.91667 64.91667 64.91667 64.91667\n[4169] 64.91667 65.91667 65.91667 65.91667 65.91667 65.83333 65.83333 65.83333\n[4177] 65.83333 65.91667 65.91667 65.91667 65.91667 67.00000 67.00000 67.00000\n[4185] 67.00000 67.00000 67.91667 67.91667 67.91667 67.91667 66.58333 66.58333\n[4193] 66.58333 66.58333 66.16667 66.16667 66.16667 66.16667 64.41667 64.41667\n[4201] 64.41667 64.41667 64.41667 63.91667 63.91667 63.91667 63.91667 62.83333\n[4209] 62.83333 62.83333 62.83333 62.58333 62.58333 62.58333 62.58333 62.83333\n[4217] 62.83333 62.83333 62.83333 62.83333 61.50000 61.50000 61.50000 61.50000\n[4225] 61.41667 61.41667 61.41667 61.41667 63.91667 63.91667 63.91667 63.91667\n[4233] 64.00000 64.00000 64.00000 64.00000 64.91667 64.91667 64.91667 64.91667\n[4241] 64.91667 65.91667 65.91667 65.91667 65.91667 65.83333 65.83333 65.83333\n[4249] 65.83333 65.91667 65.91667 65.91667 65.91667 67.00000 67.00000 67.00000\n[4257] 67.00000 67.00000 67.91667 67.91667 67.91667 67.91667 66.58333 66.58333\n[4265] 66.58333 66.58333 66.16667 66.16667 66.16667 66.16667 64.41667 64.41667\n[4273] 64.41667 64.41667 64.41667 63.91667 63.91667 63.91667 63.91667 62.83333\n[4281] 62.83333 62.83333 62.83333 62.58333 62.58333 62.58333 62.58333 62.83333\n[4289] 62.83333 62.83333 62.83333 62.83333 61.50000 61.50000 61.50000 61.50000\n[4297] 60.83333 64.33333 64.33333 64.33333 64.33333 63.08333 63.08333 63.08333\n[4305] 63.08333 65.16667 65.16667 65.16667 65.16667 66.66667 66.66667 66.66667\n[4313] 66.66667 66.66667 66.58333 66.58333 66.58333 66.58333 65.91667 65.91667\n[4321] 65.91667 65.91667 66.83333 66.83333 66.83333 66.83333 67.58333 67.58333\n[4329] 67.58333 67.58333 67.58333 67.83333 67.83333 67.83333 66.83333 66.83333\n[4337] 66.83333 66.83333 65.83333 65.83333 65.83333 65.83333 64.33333 64.33333\n[4345] 64.33333 64.33333 64.33333 64.41667 64.41667 64.41667 64.41667 63.08333\n[4353] 63.08333 63.08333 63.08333 61.41667 61.41667 61.41667 61.41667 61.41667\n[4361] 61.41667 61.41667 61.41667 61.41667 61.25000 61.25000 61.25000 61.25000\n[4369] 61.16667 63.83333 64.33333 64.33333 64.33333 64.33333 63.08333 63.08333\n[4377] 63.08333 63.08333 65.16667 65.16667 65.16667 65.16667 66.66667 66.66667\n[4385] 66.66667 66.66667 66.66667 66.58333 66.58333 66.58333 66.58333 65.91667\n[4393] 65.91667 65.91667 65.91667 66.83333 66.83333 66.83333 67.58333 67.58333\n[4401] 67.58333 67.83333 66.83333 66.83333 66.83333 66.83333 65.83333 65.83333\n[4409] 64.33333 64.33333 64.33333 64.33333 64.33333 64.41667 64.41667 64.41667\n[4417] 64.41667 63.08333 63.08333 63.08333 63.08333 61.41667 61.41667 61.41667\n[4425] 61.41667 61.41667 61.41667 61.41667 61.41667 61.41667 61.25000 61.25000\n[4433] 61.25000 61.25000 61.16667 63.83333 64.33333 64.33333 64.33333 64.33333\n[4441] 63.08333 63.08333 63.08333 63.08333 65.16667 65.16667 65.16667 65.16667\n[4449] 66.66667 66.66667 66.66667 66.66667 66.66667 66.58333 66.58333 66.58333\n[4457] 66.58333 65.91667 65.91667 65.91667 65.91667 66.83333 66.83333 67.58333\n[4465] 67.58333 67.58333 67.58333 66.83333 66.83333 66.83333 65.83333 64.33333\n[4473] 64.33333 64.33333 64.33333 64.33333 64.41667 64.41667 64.41667 64.41667\n[4481] 63.08333 63.08333 63.08333 63.08333 61.41667 61.41667 61.41667 61.41667\n[4489] 61.41667 61.41667 61.41667 61.41667 61.41667 61.25000 61.25000 61.25000\n[4497] 61.25000 61.16667 63.83333 64.33333 64.33333 64.33333 64.33333 63.08333\n[4505] 63.08333 63.08333 63.08333 65.16667 65.16667 65.16667 65.16667 66.66667\n[4513] 66.66667 66.66667 66.66667 66.66667 66.58333 66.58333 66.58333 66.58333\n[4521] 65.91667 65.91667 65.91667 65.91667 66.83333 66.83333 67.83333 67.83333\n[4529] 66.83333 66.83333 66.83333 65.83333 65.83333 64.33333 64.33333 64.33333\n[4537] 64.33333 64.33333 64.41667 64.41667 64.41667 64.41667 63.08333 63.08333\n[4545] 63.08333 63.08333 61.41667 61.41667 61.41667 61.41667 61.41667 61.41667\n[4553] 61.41667 61.41667 61.41667 61.25000 61.25000 61.25000 61.25000 61.16667\n[4561] 64.33333 64.33333 64.33333 64.33333 63.08333 63.08333 63.08333 63.08333\n[4569] 65.16667 65.16667 65.16667 65.16667 66.66667 66.66667 66.66667 66.66667\n[4577] 66.66667 66.58333 66.58333 66.58333 66.58333 65.91667 65.91667 65.91667\n[4585] 65.91667 66.83333 66.83333 65.83333 65.83333 64.33333 64.33333 64.33333\n[4593] 64.33333 64.33333 64.41667 64.41667 64.41667 64.41667 63.08333 63.08333\n[4601] 63.08333 63.08333 61.41667 61.41667 61.41667 61.41667 61.41667 61.41667\n[4609] 61.41667 61.41667 61.41667 61.25000 61.25000 61.25000 61.25000 61.16667\n[4617] 64.33333 64.33333 64.33333 63.08333 63.08333 63.08333 63.08333 65.16667\n[4625] 65.16667 65.16667 65.16667 66.66667 66.66667 66.66667 66.66667 66.66667\n[4633] 66.58333 66.58333 66.58333 66.58333 65.91667 65.91667 66.83333 65.83333\n[4641] 64.33333 64.33333 64.33333 64.33333 64.33333 64.41667 64.41667 64.41667\n[4649] 64.41667 63.08333 63.08333 63.08333 63.08333 61.41667 61.41667 61.41667\n[4657] 61.41667 61.41667 61.41667 61.41667 61.41667 61.41667 61.25000 61.25000\n[4665] 61.25000 61.25000 61.16667 66.50000 66.50000 66.50000 66.58333 66.58333\n[4673] 66.58333 66.58333 64.08333 64.08333 64.08333 64.08333 64.41667 64.41667\n[4681] 64.41667 64.41667 64.41667 66.41667 66.41667 66.41667 66.41667 66.33333\n[4689] 66.25000 66.25000 66.25000 66.25000 66.25000 64.75000 64.75000 64.75000\n[4697] 64.75000 61.00000 61.00000 61.00000 61.00000 60.16667 60.16667 60.16667\n[4705] 60.16667 61.00000 61.00000 61.00000 61.00000 61.00000 61.16667 61.16667\n[4713] 61.16667 61.16667 66.50000 66.50000 66.50000 66.58333 66.58333 66.58333\n[4721] 66.58333 64.08333 64.08333 64.08333 64.08333 64.41667 64.41667 64.41667\n[4729] 64.41667 64.41667 66.41667 66.41667 66.41667 66.41667 66.25000 66.25000\n[4737] 66.25000 64.75000 64.75000 64.75000 64.75000 61.00000 61.00000 61.00000\n[4745] 61.00000 60.16667 60.16667 60.16667 60.16667 61.00000 61.00000 61.00000\n[4753] 61.00000 61.00000 61.16667 61.16667 61.16667 66.50000 66.50000 66.50000\n[4761] 64.08333 64.08333 64.08333 64.41667 64.41667 64.41667 64.41667 64.41667\n[4769] 66.41667 66.41667 66.41667 66.25000 66.25000 66.25000 64.75000 64.75000\n[4777] 61.00000 61.00000 61.00000 60.16667 60.16667 60.16667 60.16667 61.00000\n[4785] 61.00000 61.00000 61.00000 61.00000 61.16667 61.16667 61.16667 66.50000\n[4793] 66.50000 64.08333 64.41667 64.41667 64.41667 64.41667 64.41667 66.41667\n[4801] 61.00000 61.00000 61.00000 60.16667 60.16667 60.16667 60.16667 61.00000\n[4809] 61.00000 61.00000 61.00000 61.00000 61.16667 61.16667 64.08333 64.41667\n[4817] 64.41667 64.41667 61.00000 61.00000 60.16667 60.16667 60.16667 60.16667\n[4825] 61.00000 61.00000 61.00000 61.00000 61.00000 61.16667 60.16667 60.16667\n[4833] 60.16667 60.16667 61.00000 61.00000 61.00000 61.00000 61.00000 61.16667\n[4841] 61.16667 61.16667 60.00000 60.91667 60.91667 60.91667 60.91667 60.91667\n[4849] 59.91667 59.91667 59.91667 59.91667 60.91667 60.91667 60.91667 60.91667\n[4857] 59.91667 59.91667 60.91667 60.91667 60.91667 60.91667 60.91667 59.91667\n[4865] 60.91667 60.91667 60.91667 60.91667 60.00000 60.91667 60.91667 60.00000\n[4873] 60.91667 60.91667 62.83333 62.83333 65.08333 65.08333 62.83333 62.83333\n[4881] 65.08333 65.08333 65.08333 65.08333 65.08333 62.83333 62.83333 65.08333\n[4889] 65.08333 65.08333 65.08333 65.08333 62.83333 62.83333 62.83333 65.08333\n[4897] 65.08333 65.08333 65.08333 65.08333 65.16667 65.16667 62.83333 62.83333\n[4905] 62.83333 62.83333 65.08333 65.08333 65.08333 65.08333 65.08333 65.16667\n[4913] 65.16667 62.83333 62.83333 62.83333 62.83333 65.08333 65.08333 65.08333\n[4921] 65.08333 65.08333 65.16667 68.25000 68.25000 68.25000 68.25000 74.00000\n[4929] 74.00000 74.00000 74.00000 74.00000 68.25000 68.25000 68.25000 74.00000\n[4937] 74.00000 74.00000 74.00000 68.25000 74.00000 74.00000 74.00000 74.00000\n\nggplot() + geom_sf(data = map) +\n  geom_sf(data = air_sf, aes(col = Value)) +\n  scale_color_viridis()\n\n\n\n\n\n\n\nggplot() + geom_sf(data = map) +\n  geom_sf(data = air_sf, aes(col = covtemp)) +\n  scale_color_viridis()\n\n\n\n\n\n\n\nggplot() + geom_sf(data = map) +\n  geom_sf(data = air_sf, aes(col = covprec)) +\n  scale_color_viridis()\n\n\n\n\n\n\n\nggplot() + geom_sf(data = map) +\n  geom_sf(data = dp, aes(col = covtemp)) +\n  scale_color_viridis()\n\n\n\n\n\n\n\nggplot() + geom_sf(data = map) +\n  geom_sf(data = dp, aes(col = covprec)) +\n  scale_color_viridis()\n\n\n\n\n\n\n\n\nLooks like there is a couple of nans in there. Let’s impute using the mean.\n\ndp &lt;- dp %&gt;% mutate(covprec=ifelse(is.na(covprec), mean(covprec, na.rm=TRUE), covprec),\n                    covtemp=ifelse(is.na(covtemp), mean(covtemp, na.rm=TRUE), covtemp))\nggplot() + geom_sf(data = map) +\n  geom_sf(data = dp, aes(col = covtemp)) +\n  scale_color_viridis()\n\n\n\n\n\n\n\nggplot() + geom_sf(data = map) +\n  geom_sf(data = dp, aes(col = covprec)) +\n  scale_color_viridis()\n\n\n\n\n\n\n\n\nSaw in the forum https://groups.google.com/g/r-inla-discussion-group/c/z_v2oIh2egs it’s good to work with units of kilometers which is intuitive from previous spatial data work.\n\nst_crs(\"EPSG:3857\")$proj4string\n\n[1] \"+proj=merc +a=6378137 +b=6378137 +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +k=1 +units=m +nadgrids=@null +wktext +no_defs\"\n\nprojMercator&lt;-\"+proj=merc +a=6378137 +b=6378137 +lat_ts=0 +lon_0=0\n+x_0=0 +y_0=0 +k=1 +units=km +nadgrids=@null +wktext +no_defs\"\nair_sf_project &lt;- st_transform(air_sf, crs = projMercator)\ndp &lt;- st_transform(dp, crs = projMercator)\n# Observed coordinates\ncoo &lt;- st_coordinates(air_sf_project)\n\n# Predicted coordinates\ncoop &lt;- st_coordinates(dp)\nsummary(dist(coo)) # summary of distances between locations\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n  0.5852  70.0344 109.2560 131.9875 179.8815 472.4047 \n\n\nMesh options are from https://punama.github.io/BDI_INLA/#:~:text=stack%20function.,list%20of%20effects%20(effects). max.edge controls the largest triangle edge length, and providing it with a vector c(inner, outer) sets the max edge for inside the boundary and outside the boundary. The purpose of this is to avoid boundary effects in the estimation of the model, where boundary values have high variance. Lindgren and Rue (2015) suggest to extend the domain by some amount. This is briefly discussed in the book by Blangiardo (2015).\ncutoff is the minimum allowed distance between points. Otherwise, points are replaced by a single vertex. For areas of high clusters of points, this could be useful to reduce redundancy. If no boundary is set the mesh is created on the convex hull of the observations.\nThis was inspired from https://punama.github.io/BDI_INLA/. Thanks! ::: {.cell}\nmesh0 &lt;- inla.mesh.2d(loc = coo, max.edge=c(200, 500))\nmesh1 &lt;- inla.mesh.2d(loc = coo, max.edge=c(200, 500), cutoff=1)\nmesh2 &lt;- inla.mesh.2d(loc = coo, max.edge=c(100, 150), cutoff=1)\nmesh3 &lt;- inla.mesh.2d(loc = coo, max.edge=c(100), cutoff=1)\nmesh4 &lt;- inla.mesh.2d(loc = coo, max.edge=c(500, 750))\nmesh5 &lt;- inla.mesh.2d(loc = coo, max.edge=c(500, 750), cutoff=1)\nplot(mesh0)\n\n\n\n\n\n\n\nplot(mesh1)\n\n\n\n\n\n\n\nplot(mesh2)\n\n\n\n\n\n\n\nplot(mesh3)\n\n\n\n\n\n\n\nplot(mesh4)\n\n\n\n\n\n\n\nplot(mesh5)\n\n\n\n\n\n\n\n# Using mesh0\nmesh &lt;-inla.mesh.2d(loc = coo, max.edge=c(200, 500), crs=st_crs(air_sf_project))\nmesh$n\n\n[1] 280\n\n:::\nNext we construct the A matrix that “A that projects the GRF from the observations to the vertices of the triangulated mesh.” (Moraga 2024). This A matrix has a row for each ovservation, and columns equal to the number of vertices in the mesh. That is shown above, with mesh$n. Below, two different meshes are generated. One for the observation locations, and one for the prediction locations. We need to set these both at once, because to make predictions in INLA we have to have that all pre-specified, unlike with the typical modelling style in R.\nAdditionally, the index allows us to extract fitted values from the model.\nThe smoothness parameter is set to 1, where in the spatial case \\(d=2\\) and \\(\\alpha=\\nu + d/2 = 2\\), seen in the code below.\n\nplot(mesh)\npoints(coo, col = \"red\")\naxis(1)\naxis(2)\n\n\n\n\n\n\n\nspde &lt;- inla.spde2.matern(mesh = mesh, alpha = 2, constr = TRUE)\nindexs &lt;- inla.spde.make.index(\"s\", spde$n.spde)\nlengths(indexs)\n\n      s s.group  s.repl \n    280     280     280 \n\n# Make the projection matrices\nA &lt;- inla.spde.make.A(mesh = mesh, loc = coo)\nAp &lt;- inla.spde.make.A(mesh = mesh, loc = coop)\ndim(A)\n\n[1]  52 280\n\ndim(Ap)\n\n[1] 4944  280\n\n\nThen we have to make the INLA stack. This is done because we need to combine the data for estimation with the prediction data, as well as the projection matrices. It contains the response data, the list of covariate data–here the temperature and precipitation–the projection matrices, and the indices.\n\n# stack for estimation stk.e\nstk.e &lt;- inla.stack(tag = \"est\",\ndata = list(y = air_sf_project$Value), A = list(1, A),\neffects = list(data.frame(b0 = rep(1, nrow(A)),\ncovtemp = air_sf_project$covtemp, covprec = air_sf_project$covprec),\ns = indexs))\n#stk.e\n\n# stack for prediction stk.p\nstk.p &lt;- inla.stack(tag = \"pred\",\ndata = list(y = NA), A = list(1, Ap),\neffects = list(data.frame(b0 = rep(1, nrow(Ap)),\ncovtemp = dp$covtemp, covprec = dp$covprec),\ns = indexs))\n#stk.p\n\n# stk.full has stk.e and stk.p\nstk.full &lt;- inla.stack(stk.e, stk.p)\n\nFinally, we can specify the model in INLA. All the hard work has been done above and at least the model specification in INLA is easier. This model has mean specified by \\[\n\\mu_i = \\beta_0 + \\beta_1 \\times \\text{temp}_i + \\beta_2 \\times \\text{prec}_i + S(x_i),\n\\] so there is some contribution from fixed effects as well as a unknown latent process modelled as a zero-mean Gaussian Random Field with Matern covariance function. This puts us well within INLA territory. The model equation can be seen quite clearly in the formula variable below.\n\nformula &lt;- y ~ 0 + b0 + covtemp + covprec + f(s, model = spde)\nres &lt;- inla(formula, family = \"gaussian\",\n       data = inla.stack.data(stk.full),\n       control.predictor = list(compute = TRUE,\n                                A = inla.stack.A(stk.full)),\n       control.compute = list(return.marginals.predictor = TRUE))\n\nNotice that I am passing a few options to the inla call. Importantly, control.compute. We have a nice description of the control options at https://becarioprecario.bitbucket.io/inla-gitbook/ch-INLA.html#sec:controlops. It controls what quantities are actually computed and returned during the INLA estimation. For example, there are a few different information criteria that it can return.\ncontrol.predictor will compute the posterior marginals of the parameters.\nThe options: ::: {.cell}\ninla.set.control.compute.default()\n\n$openmp.strategy\n[1] \"default\"\n\n$hyperpar\n[1] TRUE\n\n$return.marginals\n[1] TRUE\n\n$return.marginals.predictor\n[1] FALSE\n\n$dic\n[1] FALSE\n\n$mlik\n[1] TRUE\n\n$cpo\n[1] FALSE\n\n$po\n[1] FALSE\n\n$waic\n[1] FALSE\n\n$residuals\n[1] FALSE\n\n$q\n[1] FALSE\n\n$config\n[1] FALSE\n\n$likelihood.info\n[1] FALSE\n\n$smtp\nNULL\n\n$graph\n[1] FALSE\n\n$internal.opt\nNULL\n\n$save.memory\nNULL\n\n$control.gcpo\n$enable\n[1] FALSE\n\n$num.level.sets\n[1] -1\n\n$size.max\n[1] 32\n\n$strategy\n[1] \"posterior\" \"prior\"    \n\n$groups\nNULL\n\n$selection\nNULL\n\n$group.selection\nNULL\n\n$friends\nNULL\n\n$weights\nNULL\n\n$verbose\n[1] FALSE\n\n$epsilon\n[1] 0.005\n\n$prior.diagonal\n[1] 1e-04\n\n$correct.hyperpar\n[1] TRUE\n\n$keep\nNULL\n\n$remove\nNULL\n\n$remove.fixed\n[1] TRUE\n\nattr(,\"class\")\n[1] \"ctrl_gcpo\"        \"inla_ctrl_object\"\n\nattr(,\"class\")\n[1] \"ctrl_compute\"     \"inla_ctrl_object\"\n\n::: Once the model is fit, we can inspect the fixed parameters and estimated latent field, as well as the hyperparameters for the latent field. ::: {.cell}\nres$summary.fixed\n\n                mean         sd  0.025quant     0.5quant 0.975quant\nb0      -15.29769449 21.3472625 -57.7595559 -15.17245556 26.4583704\ncovtemp   2.17003514  2.0949918  -1.8002534   2.09513247  6.5392273\ncovprec  -0.01550201  0.2034683  -0.4214077  -0.01404086  0.3818577\n                mode          kld\nb0      -15.17140288 4.819848e-08\ncovtemp   2.09359434 3.231952e-07\ncovprec  -0.01411427 5.717319e-08\n\n# Latent field is here\n# res$summary.random$s\n# res$summary.hyperpar\n\nindex &lt;- inla.stack.index(stack = stk.full, tag = \"pred\")$data\npred_mean &lt;- res$summary.fitted.values[index, \"mean\"]\npred_ll &lt;- res$summary.fitted.values[index, \"0.025quant\"]\npred_ul &lt;- res$summary.fitted.values[index, \"0.975quant\"]\ngrid$mean &lt;- NA\ngrid$ll &lt;- NA\ngrid$ul &lt;- NA\n\nlength(pred_mean)\n\n[1] 4944\n\nlength(indicespointswithin)\n\n[1] 4944\n\ngrid$mean[indicespointswithin] &lt;- pred_mean\ngrid$ll[indicespointswithin] &lt;- pred_ll\ngrid$ul[indicespointswithin] &lt;- pred_ul\n  \nsummary(grid) # negative values for the lower limit\n\n      mean             ll               ul        \n Min.   :1.338   Min.   :-4.722   Min.   : 3.733  \n 1st Qu.:3.626   1st Qu.: 0.359   1st Qu.: 6.530  \n Median :4.665   Median : 1.462   Median : 7.813  \n Mean   :4.595   Mean   : 1.368   Mean   : 7.874  \n 3rd Qu.:5.553   3rd Qu.: 2.405   3rd Qu.: 9.087  \n Max.   :8.316   Max.   : 6.753   Max.   :12.860  \n NA's   :5056    NA's   :5056     NA's   :5056    \n\nlibrary(rasterVis)\n\nLoading required package: lattice\n\nlevelplot(grid, layout = c(1, 3),\nnames.attr = c(\"Mean\", \"2.5 percentile\", \"97.5 percentile\"))\n\n\n\n\n\n\n\n:::\nWhen compute=TRUE in control.predictor, we can also obtain the output below. https://www.paulamoraga.com/book-geospatial/sec-inla.html is good for info about this. ::: {.cell}\nres$summary.fitted.values\nres$summary.linear.predictor\n::: as well as marginals.linear.predictor and marginals.fitted.values.\nFrom https://becarioprecario.bitbucket.io/inla-gitbook/ch-INLA.html#model-fitting-strategies we can also see the differences using the different fitting strategies, set by the control.inla argument.\nWe can change both the Gaussian approximation strategy for the posterior full conditional distributions, as well as the integration strategy used to integrate out the \\(\\theta_{-k}\\) parameters to get the marginal distribution for \\(\\theta_k\\).\nThe \"grid\" option is the most costly, compared to the central composite design (\"ccd\"). In the empirical bayes option (\"eb\"), the posterior mode is used as the integration point.\n\napprox_strategy &lt;- c(\"gaussian\", \"simplified.laplace\", \"laplace\")\nint_strategy &lt;- c(\"ccd\", \"grid\", \"eb\")\nmodels &lt;- c(\"iid\", \"matern\")\nfits &lt;- matrix(nrow=length(approx_strategy)*length(int_strategy)*length(models), ncol=3)\nfits_marginals &lt;- vector(mode=\"list\", length=length(approx_strategy)*length(int_strategy)*length(models))\nindex_f &lt;- 0\nmodel_names &lt;- c()\nfor (m in models){\n  for(a in approx_strategy){\n    for (i in int_strategy){\n      index_f &lt;- index_f + 1\n      if (m==\"matern\"){\n        formula_approx &lt;- y ~ 0 + b0 + covtemp + covprec + f(s, model = spde)\n      }\n      else{\n        formula_approx &lt;- y ~ 0 + b0 + covtemp + covprec + f(s, model = \"iid\")\n      }\n      print(paste(a, \", \", i, \", \", m))\n      model_names &lt;- c(model_names, paste(a, \", \", i, \", \", m))\n      fit_approx &lt;- inla(formula, family = \"gaussian\",\n         data = inla.stack.data(stk.full),\n         control.inla = list(strategy = a, int.strategy = i),\n         control.compute = list(cpo = TRUE, dic = TRUE, waic = TRUE),\n         control.predictor = list(compute = TRUE, A = inla.stack.A(stk.full)))\n      fits[index_f,] &lt;- fit_approx$summary.fixed$mean\n      fits_marginals[[index_f]] &lt;- fit_approx$marginals.fixed$b0\n  }\n  }\n}\n\n[1] \"gaussian ,  ccd ,  iid\"\n[1] \"gaussian ,  grid ,  iid\"\n[1] \"gaussian ,  eb ,  iid\"\n[1] \"simplified.laplace ,  ccd ,  iid\"\n[1] \"simplified.laplace ,  grid ,  iid\"\n[1] \"simplified.laplace ,  eb ,  iid\"\n[1] \"laplace ,  ccd ,  iid\"\n[1] \"laplace ,  grid ,  iid\"\n[1] \"laplace ,  eb ,  iid\"\n[1] \"gaussian ,  ccd ,  matern\"\n[1] \"gaussian ,  grid ,  matern\"\n[1] \"gaussian ,  eb ,  matern\"\n[1] \"simplified.laplace ,  ccd ,  matern\"\n[1] \"simplified.laplace ,  grid ,  matern\"\n[1] \"simplified.laplace ,  eb ,  matern\"\n[1] \"laplace ,  ccd ,  matern\"\n[1] \"laplace ,  grid ,  matern\"\n[1] \"laplace ,  eb ,  matern\"\n\n\nLet’s compare the means of the parameters ::: {.cell}\nfits_df &lt;- as.data.frame(fits)\nnames(fits_df) &lt;- c(\"b0\", \"covtemp\", \"covprec\")\nfits_df$models &lt;- model_names\nfits_df\n\n          b0  covtemp     covprec                               models\n1  -13.85789 2.049883 -0.01973532               gaussian ,  ccd ,  iid\n2  -15.29769 2.170035 -0.01550201              gaussian ,  grid ,  iid\n3  -13.11329 1.992509 -0.02262044                gaussian ,  eb ,  iid\n4  -13.85789 2.049883 -0.01973532     simplified.laplace ,  ccd ,  iid\n5  -15.29769 2.170035 -0.01550201    simplified.laplace ,  grid ,  iid\n6  -13.11329 1.992509 -0.02262044      simplified.laplace ,  eb ,  iid\n7  -13.85789 2.049883 -0.01973532                laplace ,  ccd ,  iid\n8  -15.29769 2.170035 -0.01550201               laplace ,  grid ,  iid\n9  -13.11329 1.992509 -0.02262044                 laplace ,  eb ,  iid\n10 -13.85789 2.049883 -0.01973532            gaussian ,  ccd ,  matern\n11 -15.29769 2.170035 -0.01550201           gaussian ,  grid ,  matern\n12 -13.11329 1.992509 -0.02262044             gaussian ,  eb ,  matern\n13 -13.85789 2.049883 -0.01973532  simplified.laplace ,  ccd ,  matern\n14 -15.29769 2.170035 -0.01550201 simplified.laplace ,  grid ,  matern\n15 -13.11329 1.992509 -0.02262044   simplified.laplace ,  eb ,  matern\n16 -13.85789 2.049883 -0.01973532             laplace ,  ccd ,  matern\n17 -15.29769 2.170035 -0.01550201            laplace ,  grid ,  matern\n18 -13.11329 1.992509 -0.02262044              laplace ,  eb ,  matern\n\n::: Also compare the posteriors themselves ::: {.cell}\n# Combine dataframes\ndf_list &lt;- lapply(fits_marginals, function(m) {\n  data.frame(x = m[,1], y = m[,2]) \n})\nnew_df &lt;- do.call(rbind, df_list) \n# Add an ID column\nrow_counts &lt;- sapply(fits_marginals, nrow)\nids &lt;- factor(rep(1:length(fits_marginals), each = row_counts))\n\nWarning in rep(1:length(fits_marginals), each = row_counts): first element used\nof 'each' argument\n\nnew_df$id &lt;- ids\nlength(ids)\n\n[1] 774\n\nnew_df &lt;- new_df[1:86,]\nggplot(new_df, aes(x = x, y = y, colour = id)) + \n  geom_line() \n\n\n\n\n\n\n\n::: Wow so with this data set there is not really much different between meshes or with estimation methods.\nAnother useful feature is the set of functions that can be used to manipulate the marginal distributions. Might be useful to compute posterior quantities such as KL divergence: https://becarioprecario.bitbucket.io/inla-gitbook/ch-INLA.html#sec:marginals\nAgain from https://www.paulamoraga.com/book-geospatial/sec-inla.html is helpful.\n\ninla.mmarginal(res$marginals.fixed$b0)\n\n[1] -14.90955\n\n# Should be the same?\nres$summary.fixed$mode[1]\n\n[1] -15.1714\n\n\nNext, let’s write that model in INLABRU and check if the estimates are the same. Then, we also look at how to fit the LGCP in INLA/INLABRU.\nWne can use the same mesh and spde function as we used before. And also the same formula! (I think). But what is especially nice about INLABRU is that we don’t have to set up the stack with the projection matrices. We just model the response variable as a function of the covariates in the dataset we set up earlier and the locations of the observations. In INLABRU, we can use the sf dataset object directly.\nINLA ::: {.cell}\nformula &lt;- Value ~ Intercept(1) + covtemp + covprec + f(geometry, model = spde)\n# Fit the model for inlabru\nfit &lt;- bru(formula, data = air_sf_project, family = \"gaussian\")\n# Summarize the results\nsummary(fit)\n\ninlabru version: 2.12.0\nINLA version: 24.05.01-1\nComponents:\nIntercept: main = linear(1), group = exchangeable(1L), replicate = iid(1L), NULL\ncovtemp: main = linear(covtemp), group = exchangeable(1L), replicate = iid(1L), NULL\ncovprec: main = linear(covprec), group = exchangeable(1L), replicate = iid(1L), NULL\nf: main = spde(geometry), group = exchangeable(1L), replicate = iid(1L), NULL\nLikelihoods:\n  Family: 'gaussian'\n    Tag: ''\n    Data class: 'sf', 'grouped_df', 'tbl_df', 'tbl', 'data.frame'\n    Response class: 'numeric'\n    Predictor: Value ~ .\n    Used components: effects[Intercept, covtemp, covprec, f], latent[]\nTime used:\n    Pre = 1.82, Running = 0.739, Post = 0.314, Total = 2.87 \nFixed effects:\n             mean     sd 0.025quant 0.5quant 0.975quant    mode kld\nIntercept -15.298 21.347    -57.760  -15.172     26.458 -15.171   0\ncovtemp     2.170  2.095     -1.800    2.095      6.539   2.094   0\ncovprec    -0.016  0.203     -0.421   -0.014      0.382  -0.014   0\n\nRandom effects:\n  Name    Model\n    f SPDE2 model\n\nModel hyperparameters:\n                                          mean    sd 0.025quant 0.5quant\nPrecision for the Gaussian observations  0.308 0.080      0.177    0.299\nTheta1 for f                             1.928 0.531      0.908    1.920\nTheta2 for f                            -4.134 0.692     -5.533   -4.122\n                                        0.975quant   mode\nPrecision for the Gaussian observations      0.489  0.283\nTheta1 for f                                 2.999  1.883\nTheta2 for f                                -2.808 -4.070\n\nDeviance Information Criterion (DIC) ...............: 231.65\nDeviance Information Criterion (DIC, saturated) ....: 71.69\nEffective number of parameters .....................: 16.69\n\nWatanabe-Akaike information criterion (WAIC) ...: 232.14\nEffective number of parameters .................: 14.00\n\nMarginal log-Likelihood:  -145.00 \n is computed \nPosterior summaries for the linear predictor and the fitted values are computed\n(Posterior marginals needs also 'control.compute=list(return.marginals.predictor=TRUE)')\n\n::: That gives nearly the same estimates as from INLA. ::: {.cell}\nmap_prj &lt;- st_transform(map, crs = projMercator)\npredictions1 &lt;- predict(fit, newdata=dp, formula = ~ Intercept + covtemp + covprec + f)\npredictions2 &lt;- predict(fit, newdata=dp, formula = ~ f)\nggplot() +\ngeom_sf(data=predictions1, aes(color=mean)) +\n  scale_colour_gradient(low = \"blue\", high = \"yellow\")\n\n\n\n\n\n\n\n# Check the contribution of just the spatial field\nggplot() +\ngeom_sf(data=predictions2, aes(color=mean)) +\n  scale_colour_gradient(low = \"blue\", high = \"yellow\")\n\n\n\n\n\n\n\n::: That concludes this section, showing how to fit spatial model in INLA and inlabru. There are a few things more to do: simulating data and seeing how well INLA recovers the parameters, and fitting a temporal model in both packages. But I’ll leave these for later.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Spatial modelling with INLA and SPDE</span>"
    ]
  },
  {
    "objectID": "inla_inlabru_lgcp_tutorial_netherlands_data.html",
    "href": "inla_inlabru_lgcp_tutorial_netherlands_data.html",
    "title": "4  Implementation of LGCP in INLA and INLABRU",
    "section": "",
    "text": "4.1 LGCP in INLA introduction\nHaving completed an examination of Air Pollutoin modelling in INLA and INLABRU, it is time to move on to modelling the point process\nUsing data from GBIF.org (10 January 2025) GBIF Occurrence Download https://doi.org/10.15468/dl.p5cy6n\nFollowing https://www.paulamoraga.com/book-spatial/point-process-modeling.html for the INLA intro.\nlibrary(INLA)\n\nLoading required package: Matrix\n\n\nLoading required package: sp\n\n\nThis is INLA_24.05.01-1 built 2024-05-01 18:49:50 UTC.\n - See www.r-inla.org/contact-us for how to get help.\n - List available models/likelihoods/etc with inla.list.models()\n - Use inla.doc(&lt;NAME&gt;) to access documentation\n\nlibrary(inlabru)\n\nLoading required package: fmesher\n\nlibrary(sf)\n\nLinking to GEOS 3.11.2, GDAL 3.8.2, PROJ 9.3.1; sf_use_s2() is TRUE\n\nlibrary(ggplot2)\nlibrary(viridis)\n\nLoading required package: viridisLite\n\nlibrary(terra)\n\nterra 1.7.78\n\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:terra':\n\n    intersect, union\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(readr)\nTODO: Fix issue reading data. StillIMage is doing something\nfile_name &lt;- file.path(\"D:\", \"data\", \"gbif_observation_org_butterflies\", \"gbif_butterfly_observation-org\", \"gbif_subset_netherlands_lepidoptera.csv\")\nd &lt;- read_delim(file_name, delim='\\t', col_types=cols(infraspecificEpithet=col_character()))\nd %&gt;% filter(species==\"Lasiommata megera\") -&gt; d\ndim(d)\n\n[1] 2705   50\n\nsum(is.na(d))\n\n[1] 45001\n\nd &lt;- st_as_sf(d, coords = c(\"decimalLongitude\", \"decimalLatitude\"))\nst_crs(d) &lt;- \"EPSG:4326\"\nst_crs(\"EPSG:3857\")$proj4string\n\n[1] \"+proj=merc +a=6378137 +b=6378137 +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +k=1 +units=m +nadgrids=@null +wktext +no_defs\"\n\nprojMercator &lt;- st_crs(\"EPSG:3857\")$proj4string\nprojMercator\n\n[1] \"+proj=merc +a=6378137 +b=6378137 +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +k=1 +units=m +nadgrids=@null +wktext +no_defs\"\n\n# Observed coordinates\nd &lt;- st_transform(d, crs = projMercator)\nd\n\nSimple feature collection with 2705 features and 48 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 411882.1 ymin: 6577190 xmax: 740274.6 ymax: 7066673\nProjected CRS: WGS 84 / Pseudo-Mercator\n# A tibble: 2,705 × 49\n       gbifID datasetKey    occurrenceID kingdom phylum class order family genus\n *      &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;\n 1 4160322107 8a863029-f43… https://obs… Animal… Arthr… Inse… Lepi… Nymph… Para…\n 2 4409008265 8a863029-f43… https://obs… Animal… Arthr… Inse… Lepi… Nymph… Para…\n 3 4462065068 8a863029-f43… https://obs… Animal… Arthr… Inse… Lepi… Nymph… Para…\n 4 4160750394 8a863029-f43… https://obs… Animal… Arthr… Inse… Lepi… Nymph… Para…\n 5 4159129901 8a863029-f43… https://obs… Animal… Arthr… Inse… Lepi… Nymph… Para…\n 6 4410120094 8a863029-f43… https://obs… Animal… Arthr… Inse… Lepi… Nymph… Para…\n 7 4410216900 8a863029-f43… https://obs… Animal… Arthr… Inse… Lepi… Nymph… Para…\n 8 4409871777 8a863029-f43… https://obs… Animal… Arthr… Inse… Lepi… Nymph… Para…\n 9 4409311703 8a863029-f43… https://obs… Animal… Arthr… Inse… Lepi… Nymph… Para…\n10 4158114004 8a863029-f43… https://obs… Animal… Arthr… Inse… Lepi… Nymph… Para…\n# ℹ 2,695 more rows\n# ℹ 40 more variables: species &lt;chr&gt;, infraspecificEpithet &lt;chr&gt;,\n#   taxonRank &lt;chr&gt;, scientificName &lt;chr&gt;, verbatimScientificName &lt;chr&gt;,\n#   verbatimScientificNameAuthorship &lt;lgl&gt;, countryCode &lt;chr&gt;, locality &lt;chr&gt;,\n#   stateProvince &lt;chr&gt;, occurrenceStatus &lt;chr&gt;, individualCount &lt;dbl&gt;,\n#   publishingOrgKey &lt;chr&gt;, coordinateUncertaintyInMeters &lt;dbl&gt;,\n#   coordinatePrecision &lt;lgl&gt;, elevation &lt;lgl&gt;, elevationAccuracy &lt;lgl&gt;, …\n?st_layers\n\nstarting httpd help server ... done\n\nlayers &lt;- st_layers(file.path(\"D:\", \"data\", \"maps\", \"netherlands_bestuurlijkegrenzen_2021\", \"bestuurlijkegrenzen.gpkg\"))\n#print(str(layers))\nmap &lt;- st_read(file.path(\"D:\", \"data\", \"maps\", \"netherlands_bestuurlijkegrenzen_2021\", \"bestuurlijkegrenzen.gpkg\"), layer = \"landsgrens\")\n\nReading layer `landsgrens' from data source \n  `D:\\data\\maps\\netherlands_bestuurlijkegrenzen_2021\\bestuurlijkegrenzen.gpkg' \n  using driver `GPKG'\nSimple feature collection with 1 feature and 2 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 10425.16 ymin: 306846.2 xmax: 278026.1 ymax: 621876.3\nProjected CRS: Amersfoort / RD New\n\nmap &lt;- st_union(map)\nmap &lt;- st_as_sf(map)\nplot(map)\n\n\n\n\n\n\n\n# Damn it, there's a little isolated spec in the map!\nborder_polygon &lt;- st_cast(map, \"POLYGON\")\nborder_polygon &lt;- st_as_sfc(border_polygon)\ngeos &lt;- lapply(border_polygon, function(x) x[1])\nfor (g in geos){\n  plot(st_polygon(g))\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# Get the border polygon\nborder_final &lt;- st_polygon(geos[[1]])\n# We still need sf object\nborder_final &lt;- st_sfc(border_final, crs=st_crs(map))\nborder_final &lt;- st_as_sf(border_final)\nplot(border_final)\n\n\n\n\n\n\n\nmap &lt;- border_final\nmap &lt;- st_transform(map, crs = projMercator)\ncoo &lt;- st_coordinates(d)\nggplot() + geom_sf(data = map) +\n  geom_sf(data = d) + coord_sf(datum = projMercator)\n# raster grid covering map\ngrid &lt;- terra::rast(map, nrows = 50, ncols = 50)\n# coordinates of all cells\nxy &lt;- terra::xyFromCell(grid, 1:ncell(grid))\n# transform points to a sf object\ndp &lt;- st_as_sf(as.data.frame(xy), coords = c(\"x\", \"y\"),\n               crs = st_crs(map))\n\n# indices points within the map\nindicespointswithin &lt;- which(st_intersects(dp, map,\n                                           sparse = FALSE))\n\n# points within the map\ndp &lt;- st_filter(dp, map)\n\nggplot() + geom_sf(data = map) +\n  geom_sf(data = dp) + coord_sf(datum = projMercator)\n\n\n\n\n\n\n\ncoop &lt;- st_coordinates(dp)\nHmm, why do I need such a large unit? Something with mercator? Oh, am I in meters?\nmap\n\nSimple feature collection with 1 feature and 0 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 368237.9 ymin: 6577255 xmax: 804561.4 ymax: 7090341\nProjected CRS: WGS 84 / Pseudo-Mercator\n                               x\n1 POLYGON ((669987.2 6579597,...\n\nloc.d &lt;- cbind(st_coordinates(map)[, 1], st_coordinates(map)[, 2])\n#mesh &lt;- inla.mesh.2d(loc=coo, max.edge = c(50000, 100000))\n#mesh &lt;- inla.mesh.2d(loc.domain=loc.d)\nmesh &lt;- inla.mesh.2d(loc.domain = loc.d, max.edge = c(50000, 100000), crs=crs(d))\nmesh\n\nfm_mesh_2d object:\n  CRS:\n    LegacyPROJ4:    +proj=merc +a=6378137 +b=6378137 +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +k=1 +units=m +nadgrids=@null +wktext +no_defs\n    WKT: (only shown with verbose = TRUE)\n  Manifold: R2\n  V / E / T:    326 / 930 / 605\n  Euler char.:  1\n  Constraints:  45 boundary edges (1 group: 0), 56 interior edges (1 group: 0)\n  Bounding box: (243337.2,929462.1) x (6452354,7215241)\n  Basis d.o.f.: 326\n\nplot(mesh)\npoints(coo, col = \"red\")\naxis(1)\naxis(2)\n\n\n\n\n\n\n\n(nv &lt;- mesh$n)\n\n[1] 326\n\n(n &lt;- nrow(coo))\n\n[1] 2705\nspde &lt;- inla.spde2.matern(mesh = mesh, alpha = 2, constr = TRUE)\nbook.mesh.dual &lt;- function(mesh) {\n    if (mesh$manifold=='R2') {\n        ce &lt;- t(sapply(1:nrow(mesh$graph$tv), function(i)\n            colMeans(mesh$loc[mesh$graph$tv[i, ], 1:2])))\n        library(parallel)\n        pls &lt;- mclapply(1:mesh$n, function(i) {\n            p &lt;- unique(Reduce('rbind', lapply(1:3, function(k) {\n            j &lt;- which(mesh$graph$tv[,k]==i)\n            if (length(j)&gt;0) \n            return(rbind(ce[j, , drop=FALSE],\n            cbind(mesh$loc[mesh$graph$tv[j, k], 1] +\n            mesh$loc[mesh$graph$tv[j, c(2:3,1)[k]], 1], \n            mesh$loc[mesh$graph$tv[j, k], 2] +\n            mesh$loc[mesh$graph$tv[j, c(2:3,1)[k]], 2])/2))\n            else return(ce[j, , drop=FALSE])\n            })))\n            j1 &lt;- which(mesh$segm$bnd$idx[,1]==i)\n            j2 &lt;- which(mesh$segm$bnd$idx[,2]==i)\n            if ((length(j1)&gt;0) | (length(j2)&gt;0)) {\n            p &lt;- unique(rbind(mesh$loc[i, 1:2], p,\n            mesh$loc[mesh$segm$bnd$idx[j1, 1], 1:2]/2 +\n            mesh$loc[mesh$segm$bnd$idx[j1, 2], 1:2]/2, \n            mesh$loc[mesh$segm$bnd$idx[j2, 1], 1:2]/2 +\n            mesh$loc[mesh$segm$bnd$idx[j2, 2], 1:2]/2))\n            yy &lt;- p[,2]-mean(p[,2])/2-mesh$loc[i, 2]/2\n            xx &lt;- p[,1]-mean(p[,1])/2-mesh$loc[i, 1]/2\n            }\n            else {\n            yy &lt;- p[,2]-mesh$loc[i, 2]\n            xx &lt;- p[,1]-mesh$loc[i, 1]\n            }\n            Polygon(p[order(atan2(yy,xx)), ])\n        })\n        return(SpatialPolygons(lapply(1:mesh$n, function(i)\n            Polygons(list(pls[[i]]), i))))\n    }\n    else stop(\"It only works for R2!\")\n}\ndmesh &lt;- book.mesh.dual(mesh)\nplot(dmesh)\naxis(1)\naxis(2)\nWe then do something a little tricky. The mesh is larger than the domain that the points were observed in or the study region. So the intersections between the polygons in the mesh and the locations in \\(D\\) are computed\nplot(loc.d)\n\n\n\n\n\n\n\ndomain.polys &lt;- Polygons(list(Polygon(loc.d)), '0')\ndomainSP &lt;- SpatialPolygons(list(domain.polys))\nplot(domainSP)\n\n\n\n\n\n\n\ndomain_sf &lt;- st_as_sf(domainSP)\ncrs(domain_sf)\n\n[1] \"\"\n\ndomain_sf &lt;- st_set_crs(domain_sf, projMercator)\nst_crs(domain_sf)\n\nCoordinate Reference System:\n  User input: +proj=merc +a=6378137 +b=6378137 +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +k=1 +units=m +nadgrids=@null +wktext +no_defs \n  wkt:\nPROJCRS[\"WGS 84 / Pseudo-Mercator\",\n    BASEGEOGCRS[\"WGS 84\",\n        DATUM[\"World Geodetic System 1984\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4326]],\n    CONVERSION[\"unnamed\",\n        METHOD[\"Popular Visualisation Pseudo Mercator\",\n            ID[\"EPSG\",1024]],\n        PARAMETER[\"Latitude of natural origin\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"False easting\",0,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",0,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]]]\n\nplot(domain_sf)\n\n\n\n\n\n\n\nmesh_sf &lt;- st_as_sf(dmesh)\nmesh_sf &lt;- st_set_crs(mesh_sf, projMercator)\n# Check if the mesh polygons overlap with any of the locations \nw &lt;- sapply(1:length(dmesh), function(i) {\n  if(length(st_intersects(mesh_sf[i,], domain_sf)[[1]])&gt;0){\n    return(sf::st_area(sf::st_intersection(mesh_sf[i, ], domain_sf)))\n  }\n  else return(0)\n})\nsum(w)\n\n[1] 111060620373\n\nst_area(map)\n\n111060620373 [m^2]\nplot(mesh)\nplot(domain_sf, add=T, col=\"green\")\npoints(mesh$loc[which(w &gt; 0), 1:2], col = \"black\", pch = 20)\npoints(mesh$loc[which(w == 0), 1:2], col = \"red\", pch = 20)\nTODO: January 13th. Okay, now i’m stuck again. Finish later\ny.pp &lt;- rep(0:1, c(nv, n))\ne.pp &lt;- c(w, rep(0, n))\n# Projection matrix for the integration points (mesh vertices)\nA.int &lt;- Diagonal(nv, rep(1, nv))\n# Projection matrix for observed points (event locations)\nA.y &lt;- inla.spde.make.A(mesh = mesh, loc = coo)\n# Projection matrix for mesh vertices and event locations\nA.pp &lt;- rbind(A.int, A.y)\n\n# We also create the projection matrix Ap.pp for the prediction locations.\nAp.pp &lt;- inla.spde.make.A(mesh = mesh, loc = coop)\n# stack for estimation\nstk.e.pp &lt;- inla.stack(tag = \"est.pp\",\ndata = list(y = y.pp, e = e.pp), \nA = list(1, A.pp),\neffects = list(list(b0 = rep(1, nv + n)), list(s = 1:nv)))\n\n# stack for prediction stk.p\nstk.p.pp &lt;- inla.stack(tag = \"pred.pp\",\ndata = list(y = rep(NA, nrow(coop)), e = rep(0, nrow(coop))),\nA = list(1, Ap.pp),\neffects = list(data.frame(b0 = rep(1, nrow(coop))),\n               list(s = 1:nv)))\n\n# stk.full has stk.e and stk.p\nstk.full.pp &lt;- inla.stack(stk.e.pp, stk.p.pp)\nformula &lt;- y ~ 0 + b0 + f(s, model = spde)\nres &lt;- inla(formula,  family = 'poisson',\n  data = inla.stack.data(stk.full.pp),\n  control.inla=list(int.strategy = 'grid', strategy=\"laplace\"),\n  control.predictor = list(compute = TRUE, link = 1,\n    A = inla.stack.A(stk.full.pp)),\n    E = inla.stack.data(stk.full.pp)$e)\nres$summary.fixed\n\n       mean       sd 0.025quant 0.5quant 0.975quant    mode          kld\nb0 1.039501 1.065052  -1.049386 1.039649   3.127548 1.03965 5.801275e-11\n\nres$summary.hyperpar\n\n                  mean          sd 0.025quant   0.5quant 0.975quant       mode\nTheta1 for s   8.14040 0.001247988   8.137666   8.140495   8.142519   8.140964\nTheta2 for s -11.45034 0.009720901 -11.466856 -11.451076 -11.429055 -11.454715\n\nindex &lt;- inla.stack.index(stk.full.pp, tag = \"pred.pp\")$data\npred_mean &lt;- res$summary.fitted.values[index, \"mean\"]\npred_ll &lt;- res$summary.fitted.values[index, \"0.025quant\"]\npred_ul &lt;- res$summary.fitted.values[index, \"0.975quant\"]\ngrid$mean &lt;- NA\ngrid$ll &lt;- NA\ngrid$ul &lt;- NA\n\ngrid$mean[indicespointswithin] &lt;- pred_mean\ngrid$ll[indicespointswithin] &lt;- pred_ll\ngrid$ul[indicespointswithin] &lt;- pred_ul\nThen plot the predicted intensity\nplot(grid)\ngeom_sf(data=grid, aes(color=mean)) +\n  scale_colour_gradient(low = \"blue\", high = \"yellow\")\nWe have to make sure to get the domain for the sampler correct. The INLA code does it above, but inlabru by default does not.\nMore about that https://inlabru-org.github.io/inlabru/articles/2d_lgcp_plotsampling.html and actually the exact problem here: https://groups.google.com/g/r-inla-discussion-group/c/0bBC9bVV-L4 even though the problem was with preferential sampling. In the mesh-process R section above, you can see the manipulation to get the domains correct for INLA. Even with including sampler=domain_sf here, the estimates are not exactly the same as INLA, but closer than it was before.\nTODO: What is this domain stuff for exactly? The integration? Should be equation 3 of Simpson (2016).\n# TODO: Make sure I get the same result as inla. Options and mesh are off\n# Oh nice we can name the intercept but then need to subtract 1 to get rid of the default intercept\nformula_inlabru &lt;- geometry ~ b0(1) - 1 + f(geometry, model = spde)\nfit1 &lt;- lgcp(formula_inlabru, data=d, sampler=domain_sf, domain = list(geometry = mesh), \n             options = list(control.inla=list(int.strategy = 'ccd', strategy=\"laplace\")))\n#                          control.compute=list(config=TRUE),\n#                          control.results=list(return.marginals.random = TRUE,\n#                                               return.marginals.predictor = TRUE),\n#                          control.predictor = list(compute = TRUE)))\n\nsummary(fit1)\n\ninlabru version: 2.12.0\nINLA version: 24.05.01-1\nComponents:\nb0: main = linear(1), group = exchangeable(1L), replicate = iid(1L), NULL\nf: main = spde(geometry), group = exchangeable(1L), replicate = iid(1L), NULL\nLikelihoods:\n  Family: 'cp'\n    Tag: ''\n    Data class: 'sf', 'data.frame'\n    Response class: 'numeric'\n    Predictor: geometry ~ .\n    Used components: effects[b0, f], latent[]\nTime used:\n    Pre = 0.691, Running = 1.47, Post = 0.175, Total = 2.33 \nFixed effects:\n      mean  sd 0.025quant 0.5quant 0.975quant   mode kld\nb0 -21.688 1.4    -24.492  -21.662    -19.041 -21.66   0\n\nRandom effects:\n  Name    Model\n    f SPDE2 model\n\nModel hyperparameters:\n               mean    sd 0.025quant 0.5quant 0.975quant   mode\nTheta1 for f   8.85 0.106       8.66     8.85       9.07   8.83\nTheta2 for f -12.74 0.873     -14.74   -12.63     -11.41 -12.07\n\nDeviance Information Criterion (DIC) ...............: -126820.99\nDeviance Information Criterion (DIC, saturated) ....: NA\nEffective number of parameters .....................: -127802.62\n\nWatanabe-Akaike information criterion (WAIC) ...: 7199.81\nEffective number of parameters .................: 2414.72\n\nMarginal log-Likelihood:  -64580.42 \n is computed \nPosterior summaries for the linear predictor and the fitted values are computed\n(Posterior marginals needs also 'control.compute=list(return.marginals.predictor=TRUE)')\nTODO: Oh wow, why is b0 so different between inla and inlabru.\npredictions1 &lt;- predict(fit1, newdata=dp, formula = ~ b0 + f)\npredictions2 &lt;- predict(fit1, newdata=dp, formula = ~ f)\nggplot() +\ngeom_sf(data=predictions1, aes(color=mean)) +\n  scale_colour_gradient(low = \"blue\", high = \"yellow\")\n\n\n\n\n\n\n\n# Check the contribution of just the spatial field\nggplot() +\ngeom_sf(data=predictions2, aes(color=mean)) +\n  scale_colour_gradient(low = \"blue\", high = \"yellow\")\nThen, we can move onto multiple likelihoods and inlabru",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Implementation of LGCP in INLA and INLABRU</span>"
    ]
  }
]